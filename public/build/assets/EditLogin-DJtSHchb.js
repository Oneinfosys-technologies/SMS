import{m as w,G as x,c as I,n as L,I as T,a as b,q as y,u as r,b as V,e as t,w as U,F as B,r as p,o as d,d as u,s as A,t as D,f as H,h as M,j as z}from"./app-DCfJDSeM.js";const J={class:"grid grid-cols-3 gap-6"},K={class:"col-span-3 sm:col-span-1"},Q={class:"grid grid-cols-3 gap-6"},W={class:"col-span-3 sm:col-span-1"},X={key:0,class:"col-span-3 sm:col-span-1"},Y={class:"col-span-3 sm:col-span-1"},Z={class:"col-span-3 sm:col-span-1"},_={class:"col-span-3 sm:col-span-1"},h={class:"col-span-3 sm:col-span-1"},ee={name:"GuardianEditLogin"},se=Object.assign(ee,{props:{guardian:{type:Object,default(){return{}}}},setup(m){const $=H(),j=M(),q=z("emitter"),k=m,c={username:"",email:"",password:"",passwordConfirmation:"",roles:[]},v="guardian/",F="user/",C=w({}),n=x(v),g=I(()=>{var s,e;return(e=(s=k.guardian)==null?void 0:s.contact)==null?void 0:e.user}),l=w({isValidated:!1,existingUser:null}),o=w({...c}),G=s=>{Object.assign(C,s)},P=s=>{l.isValidated=!0,l.existingUser=s||null,o.username=s==null?void 0:s.username},R=()=>{q.emit("guardianUpdated"),j.push({name:"GuardianShowLogin",params:{uuid:k.guardian.uuid}})};return L(async()=>{var s,e,f;l.isValidated=!!g.value,l.existingUser=g.value,Object.assign(c,{username:(s=g.value)==null?void 0:s.username,email:(e=g.value)==null?void 0:e.email,roles:((f=g.value)==null?void 0:f.roles.map(i=>i.uuid))||[]}),Object.assign(o,T(c))}),(s,e)=>{const f=p("PageHeader"),i=p("BaseInput"),O=p("BaseButton"),S=p("FormAction"),E=p("BaseSelect"),N=p("ParentTransition");return d(),b(B,null,[m.guardian.uuid?(d(),y(f,{key:0,title:s.$trans(r($).meta.trans,{attribute:s.$trans(r($).meta.label)}),navs:[{label:s.$trans("guardian.guardian"),path:"Guardian"},{label:m.guardian.contact.name,path:{name:"GuardianShow",params:{uuid:m.guardian.uuid}}}]},null,8,["title","navs"])):V("",!0),t(N,{appear:"",visibility:!0},{default:U(()=>[m.guardian.uuid?(d(),b(B,{key:0},[l.isValidated?(d(),y(S,{key:1,"no-data-fetch":"","pre-requisites":!0,"pre-requisite-url":F,onSetPreRequisites:G,"init-url":v,action:l.existingUser?"updateUser":"createUser","init-form":c,form:o,"after-submit":R},{default:U(()=>[u("div",Q,[u("div",W,[t(i,{readonly:"",disabled:"",type:"text",modelValue:o.email,"onUpdate:modelValue":e[2]||(e[2]=a=>o.email=a),name:"email",label:s.$trans("contact.login.props.email"),error:r(n).email,"onUpdate:error":e[3]||(e[3]=a=>r(n).email=a)},null,8,["modelValue","label","error"])]),l.existingUser?(d(),b("div",X,[t(i,{readonly:"",disabled:"",type:"text",modelValue:o.username,"onUpdate:modelValue":e[4]||(e[4]=a=>o.username=a),name:"username",label:s.$trans("contact.login.props.username"),error:r(n).username,"onUpdate:error":e[5]||(e[5]=a=>r(n).username=a)},null,8,["modelValue","label","error"])])):V("",!0),l.existingUser?V("",!0):(d(),b(B,{key:1},[u("div",Y,[t(i,{type:"text",modelValue:o.username,"onUpdate:modelValue":e[6]||(e[6]=a=>o.username=a),name:"username",label:s.$trans("contact.login.props.username"),error:r(n).username,"onUpdate:error":e[7]||(e[7]=a=>r(n).username=a)},null,8,["modelValue","label","error"])]),u("div",Z,[t(i,{type:"password",modelValue:o.password,"onUpdate:modelValue":e[8]||(e[8]=a=>o.password=a),name:"password",label:s.$trans("contact.login.props.password"),error:r(n).password,"onUpdate:error":e[9]||(e[9]=a=>r(n).password=a)},null,8,["modelValue","label","error"])]),u("div",_,[t(i,{type:"password",modelValue:o.passwordConfirmation,"onUpdate:modelValue":e[10]||(e[10]=a=>o.passwordConfirmation=a),name:"passwordConfirmation",label:s.$trans("contact.login.props.password_confirmation"),error:r(n).passwordConfirmation,"onUpdate:error":e[11]||(e[11]=a=>r(n).passwordConfirmation=a)},null,8,["modelValue","label","error"])])],64)),u("div",h,[t(E,{modelValue:o.roles,"onUpdate:modelValue":e[12]||(e[12]=a=>o.roles=a),name:"roles",label:s.$trans("contact.login.props.role"),options:C.roles,multiple:"","label-prop":"label","value-prop":"uuid",error:r(n).roles,"onUpdate:error":e[13]||(e[13]=a=>r(n).roles=a)},null,8,["modelValue","label","options","error"])])])]),_:1},8,["action","form"])):(d(),y(S,{key:0,"no-action-button":"","no-data-fetch":"","init-url":v,action:"confirmUser","init-form":c,form:o,"after-submit":P,"stay-on":"",redirect:{name:"GuardianShowLogin",params:{uuid:m.guardian.uuid}}},{default:U(()=>[u("div",J,[u("div",K,[t(i,{type:"text",modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=a=>o.email=a),name:"email",label:s.$trans("contact.login.props.email"),error:r(n).email,"onUpdate:error":e[1]||(e[1]=a=>r(n).email=a)},null,8,["modelValue","label","error"])])]),t(O,{class:"mt-4",type:"submit"},{default:U(()=>[A(D(s.$trans("general.validate")),1)]),_:1})]),_:1},8,["form","redirect"]))],64)):V("",!0)]),_:1})],64)}}});export{se as default};
