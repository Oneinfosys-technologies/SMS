import{f as j,m as M,n as z,r as l,o,q as y,w as t,d as C,e as n,a as d,b as v,s as m,t as u,c as G,l as J,u as i,v as I,F as H,y as K,h as Q,j as R}from"./app-DCfJDSeM.js";const X={class:"grid grid-cols-3 gap-6"},Y={class:"col-span-3 sm:col-span-1"},Z={key:0,class:"col-span-3 sm:col-span-1"},ee={key:1,class:"col-span-3 sm:col-span-1"},te={key:2,class:"col-span-3 sm:col-span-1"},ae={class:"col-span-3 sm:col-span-1"},ne={__name:"Filter",emits:["hide"],setup(p,{emit:S}){const V=j(),f=S,h={type:"",admissionNumber:"",employeeCode:"",batches:[],startDate:"",endDate:""},s=M({...h}),$=M({isLoaded:!V.query.batches});return z(async()=>{$.batches=V.query.batches?V.query.batches.split(","):[],$.isLoaded=!0}),(c,r)=>{const k=l("BaseSelect"),g=l("BaseInput"),T=l("BaseSelectSearch"),w=l("DatePicker"),_=l("FilterForm");return o(),y(_,{"init-form":h,form:s,multiple:["batches"],onHide:r[6]||(r[6]=e=>f("hide"))},{default:t(()=>[C("div",X,[C("div",Y,[n(k,{name:"type",label:c.$trans("general.type"),modelValue:s.type,"onUpdate:modelValue":r[0]||(r[0]=e=>s.type=e),options:[{label:c.$trans("employee.employee"),value:"employee"},{label:c.$trans("student.student"),value:"student"}]},null,8,["label","modelValue","options"])]),s.type=="student"?(o(),d("div",Z,[n(g,{type:"text",modelValue:s.admissionNumber,"onUpdate:modelValue":r[1]||(r[1]=e=>s.admissionNumber=e),name:"admissionNumber",label:c.$trans("student.admission.props.code_number")},null,8,["modelValue","label"])])):v("",!0),s.type=="employee"?(o(),d("div",ee,[n(g,{type:"text",modelValue:s.employeeCode,"onUpdate:modelValue":r[2]||(r[2]=e=>s.employeeCode=e),name:"employeeCode",label:c.$trans("employee.props.code_number")},null,8,["modelValue","label"])])):v("",!0),s.type=="student"?(o(),d("div",te,[$.isLoaded?(o(),y(T,{key:0,multiple:"",name:"batches",label:c.$trans("global.select",{attribute:c.$trans("academic.batch.batch")}),modelValue:s.batches,"onUpdate:modelValue":r[3]||(r[3]=e=>s.batches=e),"value-prop":"uuid","init-search":$.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:t(e=>[m(u(e.value.course.nameWithTerm)+" "+u(e.value.name),1)]),listOption:t(e=>[m(u(e.option.course.nameWithTerm)+" "+u(e.option.name),1)]),_:1},8,["label","modelValue","init-search"])):v("",!0)])):v("",!0),C("div",ae,[n(w,{start:s.startDate,"onUpdate:start":r[4]||(r[4]=e=>s.startDate=e),end:s.endDate,"onUpdate:end":r[5]||(r[5]=e=>s.endDate=e),name:"dateBetween",as:"range",label:c.$trans("general.date_between")},null,8,["start","end","label"])])])]),_:1},8,["form"])}}},oe={key:0},se=["innerHTML"],le={key:1},re={key:2},ue={key:0},ie={name:"FormSubmission"},de=Object.assign(ie,{props:{form:{type:Object,default(){return{}}}},setup(p){const S=j(),V=Q(),f=R("$trans"),h=R("emitter"),s=p;let $=["filter"];const c="form/submission/",r=G(()=>s.form.fields.filter(_=>_.showValue)),k=J(!1),g=M({}),T=_=>{Object.assign(g,_)},w=(_,e)=>{let F=_.responses.find(B=>B.uuid===e.uuid);return F?F.type==="camera_image"?F.value.map(B=>`<a href="${B}" target="_blank">${f("general.image")}</a>`).join("<br>"):F.value:"-"};return(_,e)=>{const F=l("PageHeaderAction"),B=l("PageHeader"),N=l("ParentTransition"),D=l("DataCell"),L=l("TextMuted"),U=l("FloatingMenuItem"),P=l("FloatingMenu"),q=l("DataRow"),A=l("DataTable"),O=l("BaseHeading"),x=l("BaseDataView"),W=l("BaseCard"),E=l("ListItem");return o(),y(E,{"init-url":c,uuid:i(S).params.uuid,onSetItems:T},{header:t(()=>[p.form.uuid?(o(),y(B,{key:0,title:i(f)("form.submission.submission"),navs:[{label:i(f)("form.form"),path:"Form"},{label:p.form.name,path:{name:"FormShow",params:{uuid:p.form.uuid}}}]},{default:t(()=>[n(F,{url:`forms/${p.form.uuid}/submissions/`,name:"FormSubmission",title:i(f)("form.submission.submission"),actions:i($),"dropdown-actions":["print","pdf","excel"],onToggleFilter:e[0]||(e[0]=a=>k.value=!k.value)},null,8,["url","title","actions"])]),_:1},8,["title","navs"])):v("",!0)]),filter:t(()=>[n(N,{appear:"",visibility:k.value},{default:t(()=>[n(ne,{onRefresh:e[1]||(e[1]=a=>i(h).emit("listItems")),onHide:e[2]||(e[2]=a=>k.value=!1)})]),_:1},8,["visibility"])]),default:t(()=>[n(N,{appear:"",visibility:!0},{default:t(()=>[n(A,{header:g.headers,meta:g.meta,module:"form.submission",onRefresh:e[3]||(e[3]=a=>i(h).emit("listItems"))},{actionButton:t(()=>e[4]||(e[4]=[])),default:t(()=>[(o(!0),d(H,null,I(g.data,a=>(o(),y(q,{key:a.uuid},{default:t(()=>[n(D,{name:"name"},{default:t(()=>[m(u(a.type.label),1)]),_:2},1024),n(D,{name:"name"},{default:t(()=>[m(u(a.name)+" ",1),n(L,{block:""},{default:t(()=>[m(u(a.codeNumber),1)]),_:2},1024),a.detail?(o(),y(L,{key:0},{default:t(()=>[m(u(a.detail),1)]),_:2},1024)):v("",!0)]),_:2},1024),(o(!0),d(H,null,I(r.value,b=>(o(),y(D,null,{default:t(()=>[b.type.value==="camera_image"?(o(),d("div",oe,[C("div",{innerHTML:w(a,b)},null,8,se)])):b.type.value==="file_upload"?(o(),d("div",le," - ")):(o(),d("div",re,u(w(a,b)),1))]),_:2},1024))),256)),n(D,{name:"submittedAt"},{default:t(()=>[m(u(a.submittedAt.formatted),1)]),_:2},1024),n(D,{name:"action"},{default:t(()=>[n(P,null,{default:t(()=>[n(U,{icon:"fas fa-arrow-circle-right",onClick:b=>i(V).push({name:"FormSubmissionShow",params:{uuid:p.form.uuid,muuid:a.uuid}})},{default:t(()=>[m(u(i(f)("general.show")),1)]),_:2},1032,["onClick"]),i(K)("form:edit")?(o(),y(U,{key:0,icon:"fas fa-trash",onClick:b=>i(h).emit("deleteItem",{uuid:p.form.uuid,moduleUuid:a.uuid})},{default:t(()=>[m(u(i(f)("general.delete")),1)]),_:2},1032,["onClick"])):v("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","meta"]),n(W,{class:"mt-4"},{title:t(()=>[m(u(p.form.name),1)]),default:t(()=>[n(O,null,{default:t(()=>[m(u(i(f)("form.props.question")),1)]),_:1}),(o(!0),d(H,null,I(r.value,(a,b)=>(o(),d("div",null,[n(x,null,{default:t(()=>[m("("+u(b+1)+") "+u(a.label)+" ",1),a.type.value=="file_upload"||a.type.value=="camera_image"?(o(),d("span",ue," ("+u(a.name)+") ",1)):v("",!0)]),_:2},1024)]))),256))]),_:1})]),_:1})]),_:1},8,["uuid"])}}});export{de as default};
