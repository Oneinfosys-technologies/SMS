import{f as re,m as L,n as ue,r as f,o as n,q as m,w as e,d as C,e as u,s as i,t as s,a as _,b as d,y as x,C as I,l as K,u as t,j as Q,v as D,A as H,F as V,h as me,i as de,L as P,z as ce}from"./app-DCfJDSeM.js";const fe={class:"grid grid-cols-3 gap-6"},pe={class:"col-span-3 sm:col-span-1"},_e={key:0},be={key:0},he={class:"col-span-3 sm:col-span-1"},xe={__name:"Filter",props:{preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(N,{emit:B}){const k=re(),o=B,v={batches:[],exams:[]},$=L({...v}),F=L({batches:[],exams:[],isLoaded:!(k.query.batches||k.query.exams)});return ue(async()=>{F.batches=k.query.batches?k.query.batches.split(","):[],F.exams=k.query.exams?k.query.exams.split(","):[],F.isLoaded=!0}),(b,S)=>{const E=f("BaseSelect"),h=f("BaseSelectSearch"),A=f("FilterForm");return n(),m(A,{"init-form":v,form:$,multiple:["exams","batches"],onHide:S[2]||(S[2]=l=>o("hide"))},{default:e(()=>[C("div",fe,[C("div",pe,[u(E,{multiple:"",modelValue:$.exams,"onUpdate:modelValue":S[0]||(S[0]=l=>$.exams=l),name:"exams",label:b.$trans("global.select",{attribute:b.$trans("exam.exam")}),"track-by":["name"],"value-prop":"uuid",options:N.preRequisites.exams},{selectedOption:e(l=>{var T,j;return[i(s(l.value.name)+" ",1),l.value.term?(n(),_("span",_e,"("+s(((j=(T=l.value.term)==null?void 0:T.division)==null?void 0:j.name)||b.$trans("general.all"))+")",1)):d("",!0)]}),listOption:e(l=>{var T,j;return[i(s(l.option.name)+" ",1),l.option.term?(n(),_("span",be,"("+s(((j=(T=l.option.term)==null?void 0:T.division)==null?void 0:j.name)||b.$trans("general.all"))+")",1)):d("",!0)]}),_:1},8,["modelValue","label","options"])]),C("div",he,[F.isLoaded?(n(),m(h,{key:0,multiple:"",name:"batches",label:b.$trans("global.select",{attribute:b.$trans("academic.batch.batch")}),modelValue:$.batches,"onUpdate:modelValue":S[1]||(S[1]=l=>$.batches=l),"value-prop":"uuid","init-search":F.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:e(l=>[i(s(l.value.course.name)+" "+s(l.value.name),1)]),listOption:e(l=>[i(s(l.option.course.nameWithTerm)+" "+s(l.option.name),1)]),_:1},8,["label","modelValue","init-search"])):d("",!0)])])]),_:1},8,["form"])}}},ke={class:"grid grid-cols-1 gap-4 px-4 pt-4 lg:grid-cols-2"},ve={class:"py-2 text-center"},ye=["onClick"],ge={key:0},Ce={key:0},$e={class:"text-xl font-semibold"},Se={class:"ml-1 space-x-1"},we={key:0,class:"fas fa-file-lines"},Fe={key:1,class:"fas fa-id-card"},qe={name:"ExamScheduleList"},Te=Object.assign(qe,{setup(N){const B=me(),k=de(),o=Q("$trans"),v=Q("emitter");let $=[];x("exam-schedule:create")&&$.unshift("create"),I(["student","guardian"],"any")||$.unshift("filter");let F=[];x("exam-schedule:export")&&(F=["print","pdf","excel"]);const b="exam/schedule/",S=L({exams:[]}),E=[{key:"subject",label:o("academic.subject.subject"),visibility:!0},{key:"date",label:o("exam.schedule.props.date"),visibility:!0},{key:"assessment",label:o("exam.assessment.assessment"),visibility:!0}],h=K(!1),A=K(!1),l=L({}),T=p=>{Object.assign(l,p)},j=p=>{Object.assign(S,p)},X=p=>p.filter(c=>c.date.value),Y=async p=>{await P()&&(h.value=!0,await k.dispatch(b+"copyToCourse",{uuid:p.uuid}).then(c=>{h.value=!1,v.emit("listItems")}).catch(c=>{h.value=!1}))},U=async(p,c)=>{await P()&&(h.value=!0,await k.dispatch(b+"updateForm",{uuid:p.uuid,value:c}).then(R=>{h.value=!1,v.emit("listItems")}).catch(R=>{h.value=!1}))},W=async(p,c)=>{await P()&&(h.value=!0,await k.dispatch(b+"togglePublishAdmitCard",{uuid:p.uuid}).then(R=>{h.value=!1,v.emit("listItems")}).catch(R=>{h.value=!1}))};return(p,c)=>{const R=f("PageHeaderAction"),Z=f("PageHeader"),M=f("ParentTransition"),y=f("TextMuted"),z=f("BaseBadge"),g=f("DataCell"),G=f("DataRow"),ee=f("SimpleTable"),te=f("CardView"),ae=f("Pagination"),se=f("CardList"),w=f("FloatingMenuItem"),ne=f("FloatingMenu"),ie=f("BaseButton"),oe=f("DataTable"),le=f("ListItem"),O=ce("tooltip");return n(),m(le,{"init-url":b,"pre-requisites":!t(I)(["student","guardian"],"any"),onSetPreRequisites:j,onSetItems:T},{header:e(()=>[u(Z,{title:t(o)("exam.schedule.schedule"),navs:[{label:t(o)("exam.exam"),path:"Exam"}]},{default:e(()=>[u(R,{url:"exam/schedules/",name:"ExamSchedule",title:t(o)("exam.schedule.schedule"),actions:t($),"dropdown-actions":t(F),onToggleFilter:c[0]||(c[0]=a=>A.value=!A.value)},null,8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"])]),filter:e(()=>[u(M,{appear:"",visibility:A.value},{default:e(()=>[u(xe,{onRefresh:c[1]||(c[1]=a=>t(v).emit("listItems")),"pre-requisites":S,onHide:c[2]||(c[2]=a=>A.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"])]),default:e(()=>[t(I)(["student","guardian"],"any")?(n(),m(M,{key:0,appear:"",visibility:!0},{default:e(()=>[u(se,{header:l.headers,meta:l.meta},{content:e(()=>[C("div",$e,s(t(o)("dashboard.nothing_to_show")),1)]),default:e(()=>[C("div",ke,[(n(!0),_(V,null,D(l.data,a=>(n(),m(te,{key:a.uuid,"no-padding":""},{default:e(()=>[C("div",ve,[i(s(a.exam.name)+" ",1),t(I)("student")&&a.hasForm?H((n(),_("span",{key:0,class:"cursor-pointer",onClick:r=>t(B).push({name:"ExamScheduleFormSubmission",params:{uuid:a.uuid}})},c[6]||(c[6]=[C("i",{class:"fas fa-arrow-up-right-from-square"},null,-1)]),8,ye)),[[O,t(o)("exam.schedule.form")]]):d("",!0),u(y,{block:""},{default:e(()=>[i(s(a.batch.course.name)+" "+s(a.batch.name),1)]),_:2},1024),a.isReassessment?(n(),m(z,{key:1},{default:e(()=>[i(s(t(o)("exam.schedule.reassessment")+" ("+a.attempt.label+")"),1)]),_:2},1024)):d("",!0)]),a.records.length>0?(n(),m(ee,{key:0,header:E},{default:e(()=>[(n(!0),_(V,null,D(X(a.records),r=>(n(),m(G,{key:r.uuid},{default:e(()=>[u(g,{name:"subject"},{default:e(()=>[i(s(r.subject.name)+" ",1),r.subject.code?(n(),_("span",ge,"("+s(r.subject.code)+")",1)):d("",!0),r.hasGrading?(n(),m(y,{key:1,block:""},{default:e(()=>[i("("+s(t(o)("exam.schedule.props.grading"))+")",1)]),_:1})):d("",!0)]),_:2},1024),u(g,{name:"date"},{default:e(()=>[i(s(r.date.formatted)+" ",1),r.startTime.value?(n(),m(y,{key:0,block:""},{default:e(()=>[i(s(r.startTime.formatted)+" ",1),r.endTime.value?(n(),_("span",Ce,"- "+s(r.endTime.formatted),1)):d("",!0)]),_:2},1024)):d("",!0)]),_:2},1024),u(g,{name:"assessment"},{default:e(()=>[(n(!0),_(V,null,D(r.assessments,q=>(n(),_("div",null,[i(s(q.name)+" ",1),u(y,null,{default:e(()=>[i(s(q.maxMark),1)]),_:2},1024)]))),256))]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)):d("",!0)]),_:2},1024))),128))]),C("div",null,[u(ae,{"card-view":"",meta:l.meta,onRefresh:c[3]||(c[3]=a=>t(v).emit("listItems"))},null,8,["meta"])])]),_:1},8,["header","meta"])]),_:1})):(n(),m(M,{key:1,appear:"",visibility:!0},{default:e(()=>[u(oe,{header:l.headers,meta:l.meta,module:"exam.schedule",onRefresh:c[5]||(c[5]=a=>t(v).emit("listItems"))},{actionButton:e(()=>[t(x)("exam-schedule:create")?(n(),m(ie,{key:0,onClick:c[4]||(c[4]=a=>t(B).push({name:"ExamScheduleCreate"}))},{default:e(()=>[i(s(t(o)("global.add",{attribute:t(o)("exam.schedule.schedule")})),1)]),_:1})):d("",!0)]),default:e(()=>[(n(!0),_(V,null,D(l.data,a=>(n(),m(G,{key:a.uuid},{default:e(()=>[u(g,{name:"exam"},{default:e(()=>{var r;return[C("span",null,s(a.exam.name),1),C("span",Se,[a.hasForm&&t(x)("exam-schedule:edit")?H((n(),_("i",we,null,512)),[[O,t(o)("exam.form.form")]]):d("",!0),a.publishAdmitCard?H((n(),_("i",Fe,null,512)),[[O,t(o)("exam.admit_card.admit_card")]]):d("",!0)]),u(y,{block:""},{default:e(()=>{var q,J;return[i(s((J=(q=a.exam.term)==null?void 0:q.division)==null?void 0:J.name),1)]}),_:2},1024),a.isReassessment?(n(),m(z,{key:0},{default:e(()=>[i(s(t(o)("exam.schedule.reassessment")+" ("+a.attempt.label+")"),1)]),_:2},1024)):d("",!0),(r=a.examConfig)!=null&&r.publishMarksheet?(n(),m(y,{key:1,block:"",class:"text-success"},{default:e(()=>[i(s(t(o)("exam.marksheet.published")),1)]),_:1})):d("",!0)]}),_:2},1024),u(g,{name:"batch"},{default:e(()=>[i(s(a.batch.course.name)+" ",1),u(y,{block:""},{default:e(()=>[i(s(a.batch.name),1)]),_:2},1024)]),_:2},1024),u(g,{name:"assessment"},{default:e(()=>{var r;return[i(s(a.assessment.name)+" ",1),u(y,{block:""},{default:e(()=>{var q;return[i(s((q=a.observation)==null?void 0:q.name),1)]}),_:2},1024),((r=a.marksheetStatus)==null?void 0:r.value)=="processed"?(n(),m(y,{key:0,block:"",class:"text-info"},{default:e(()=>[i(s(t(o)("exam.marksheet.processed")),1)]),_:1})):d("",!0)]}),_:2},1024),u(g,{name:"grade"},{default:e(()=>[i(s(a.grade.name),1)]),_:2},1024),u(g,{name:"period"},{default:e(()=>[i(s(a.startDate.formatted)+" ",1),u(y,{block:""},{default:e(()=>[i(s(a.endDate.formatted),1)]),_:2},1024)]),_:2},1024),u(g,{name:"createdAt"},{default:e(()=>[i(s(a.createdAt.formatted),1)]),_:2},1024),u(g,{name:"action"},{default:e(()=>[u(ne,null,{default:e(()=>[t(I)("student")&&a.hasForm?(n(),m(w,{key:0,icon:"fas fa-file-lines",onClick:r=>t(B).push({name:"ExamScheduleFormSubmission",params:{uuid:a.uuid}})},{default:e(()=>[i(s(t(o)("exam.schedule.form")),1)]),_:2},1032,["onClick"])):d("",!0),u(w,{icon:"fas fa-arrow-circle-right",onClick:r=>t(B).push({name:"ExamScheduleShow",params:{uuid:a.uuid}})},{default:e(()=>[i(s(t(o)("general.show")),1)]),_:2},1032,["onClick"]),t(x)("exam-schedule:edit")?(n(),m(w,{key:1,icon:"fas fa-edit",onClick:r=>t(B).push({name:"ExamScheduleEdit",params:{uuid:a.uuid}})},{default:e(()=>[i(s(t(o)("general.edit")),1)]),_:2},1032,["onClick"])):d("",!0),t(x)("exam-schedule:create")&&a.batch.course.batchWithSameSubject?(n(),m(w,{key:2,icon:"fas fa-copy",onClick:r=>Y(a)},{default:e(()=>[i(s(t(o)("exam.schedule.copy_to_course")),1)]),_:2},1032,["onClick"])):d("",!0),t(x)("exam-schedule:edit")&&!a.hasForm?(n(),m(w,{key:3,icon:"fas fa-file",onClick:r=>U(a,!0)},{default:e(()=>[i(s(t(o)("global.enable",{attribute:t(o)("exam.form.form")})),1)]),_:2},1032,["onClick"])):d("",!0),t(x)("exam-schedule:edit")&&a.hasForm?(n(),m(w,{key:4,icon:"fas fa-file",onClick:r=>U(a,!1)},{default:e(()=>[i(s(t(o)("global.disable",{attribute:t(o)("exam.form.form")})),1)]),_:2},1032,["onClick"])):d("",!0),t(x)("exam-schedule:edit")&&!a.publishAdmitCard?(n(),m(w,{key:5,icon:"fas fa-id-card",onClick:r=>W(a)},{default:e(()=>[i(s(t(o)("global.publish",{attribute:t(o)("exam.admit_card.admit_card")})),1)]),_:2},1032,["onClick"])):d("",!0),t(x)("exam-schedule:edit")&&a.publishAdmitCard?(n(),m(w,{key:6,icon:"fas fa-id-card",onClick:r=>W(a)},{default:e(()=>[i(s(t(o)("global.unpublish",{attribute:t(o)("exam.admit_card.admit_card")})),1)]),_:2},1032,["onClick"])):d("",!0),t(x)("exam-schedule:delete")?(n(),m(w,{key:7,icon:"fas fa-trash",onClick:r=>t(v).emit("deleteItem",{uuid:a.uuid})},{default:e(()=>[i(s(t(o)("general.delete")),1)]),_:2},1032,["onClick"])):d("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","meta"])]),_:1}))]),_:1},8,["pre-requisites"])}}});export{Te as default};
