import{f as W,m as C,n as z,r as o,o as l,q as y,w as e,d as f,s as c,t as a,b as g,e as n,y as $,l as G,u as d,C as J,a as D,v as L,F as S,h as K,j as Q}from"./app-DCfJDSeM.js";const X={class:"grid grid-cols-3 gap-6"},Y={class:"col-span-3 sm:col-span-1"},Z={class:"col-span-3 sm:col-span-1"},ee={class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-1"},se={__name:"Filter",props:{preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(P,{emit:v}){const m=W(),q=v,w=P,R={employees:[],batches:[],subjects:[],startDate:"",endDate:""},u=C({...R}),B=C({subjects:w.preRequisites.subjects}),i=C({employees:[],batches:[],subjects:[],isLoaded:!(m.query.employees||m.query.batches||m.query.subjects)});return z(async()=>{i.employees=m.query.employees?m.query.employees.split(","):[],i.batches=m.query.batches?m.query.batches.split(","):[],i.subjects=m.query.subjects?m.query.subjects.split(","):[],i.isLoaded=!0}),(h,p)=>{const r=o("BaseSelectSearch"),b=o("BaseSelect"),F=o("DatePicker"),I=o("FilterForm");return l(),y(I,{"init-form":R,form:u,multiple:["employees","batches","subjects"],onHide:p[5]||(p[5]=t=>q("hide"))},{default:e(()=>[f("div",X,[f("div",Y,[i.isLoaded?(l(),y(r,{key:0,multiple:"",name:"employees",label:h.$trans("global.select",{attribute:h.$trans("employee.employee")}),modelValue:u.employees,"onUpdate:modelValue":p[0]||(p[0]=t=>u.employees=t),"value-prop":"uuid","init-search":i.employees,"search-key":"name","search-action":"employee/list"},{selectedOption:e(t=>[c(a(t.value.name)+" ("+a(t.value.codeNumber)+") ",1)]),listOption:e(t=>[c(a(t.option.name)+" ("+a(t.option.codeNumber)+") ",1)]),_:1},8,["label","modelValue","init-search"])):g("",!0)]),f("div",Z,[i.isLoaded?(l(),y(r,{key:0,multiple:"",name:"batches",label:h.$trans("global.select",{attribute:h.$trans("academic.batch.batch")}),modelValue:u.batches,"onUpdate:modelValue":p[1]||(p[1]=t=>u.batches=t),"value-prop":"uuid","init-search":i.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:e(t=>[c(a(t.value.course.name)+" "+a(t.value.name),1)]),listOption:e(t=>[c(a(t.option.course.nameWithTerm)+" "+a(t.option.name),1)]),_:1},8,["label","modelValue","init-search"])):g("",!0)]),f("div",ee,[n(b,{multiple:"",modelValue:u.subjects,"onUpdate:modelValue":p[2]||(p[2]=t=>u.subjects=t),name:"subjects",label:h.$trans("academic.subject.subject"),"label-prop":"name","value-prop":"uuid",options:B.subjects},null,8,["modelValue","label","options"])]),f("div",te,[n(F,{start:u.startDate,"onUpdate:start":p[3]||(p[3]=t=>u.startDate=t),end:u.endDate,"onUpdate:end":p[4]||(p[4]=t=>u.endDate=t),name:"startDateBetween",as:"range",label:h.$trans("general.date_between")},null,8,["start","end","label"])])])]),_:1},8,["form"])}}},ae={class:"grid grid-cols-1 gap-4 px-4 pt-4 md:grid-cols-2 lg:grid-cols-3"},ne=["onClick"],oe={class:"px-2 py-2 text-gray-800 dark:text-gray-400"},ie={class:"flex items-center justify-between"},re={class:"font-medium"},le={class:"mt-2 flex justify-between items-center"},ue={class:"text-sm font-medium"},de={class:"text-xl font-semibold"},ce={name:"ResourceDiaryList"},pe=Object.assign(ce,{setup(P){const v=K(),m=Q("emitter");let q=["filter"];$("student-diary:create")&&q.unshift("create");let w=[];$("student-diary:export")&&(w=["print","pdf","excel"]);const R="resource/diary/",u=G(!1),B=C({subjects:[]}),i=C({}),h=r=>{Object.assign(B,r)},p=r=>{Object.assign(i,r)};return(r,b)=>{const F=o("PageHeaderAction"),I=o("PageHeader"),t=o("ParentTransition"),O=o("CardView"),A=o("Pagination"),M=o("CardList"),k=o("DataCell"),T=o("TextMuted"),V=o("FloatingMenuItem"),N=o("FloatingMenu"),U=o("DataRow"),H=o("BaseButton"),E=o("DataTable"),x=o("ListItem");return l(),y(x,{"init-url":R,"pre-requisites":!0,onSetPreRequisites:h,"additional-query":{},onSetItems:p},{header:e(()=>[n(I,{title:r.$trans("resource.diary.diary"),navs:[{label:r.$trans("resource.resource"),path:"Resource"}]},{default:e(()=>[n(F,{url:"resource/diaries/",name:"ResourceDiary",title:r.$trans("resource.diary.diary"),actions:d(q),"dropdown-actions":d(w),onToggleFilter:b[0]||(b[0]=s=>u.value=!u.value)},null,8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"])]),filter:e(()=>[n(t,{appear:"",visibility:u.value},{default:e(()=>[n(se,{onRefresh:b[1]||(b[1]=s=>d(m).emit("listItems")),"pre-requisites":B,onHide:b[2]||(b[2]=s=>u.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"])]),default:e(()=>[d(J)(["student","guardian"],"any")?(l(),y(t,{key:0,appear:"",visibility:!0},{default:e(()=>[n(M,{header:i.headers,meta:i.meta},{content:e(()=>[f("div",de,a(r.$trans("dashboard.nothing_to_show")),1)]),default:e(()=>[f("div",ae,[(l(!0),D(S,null,L(i.data,s=>(l(),D("div",{key:s.uuid,class:"cursor-pointer",onClick:_=>d(v).push({name:"ResourceDiaryPreview",query:{batch:s.batchUuid,date:s.date.value}})},[n(O,{"no-padding":""},{default:e(()=>[f("div",oe,[f("div",ie,[f("span",re,a(s.date.formatted),1)]),f("div",le,[f("span",ue,a(s.courseBatch),1)])])]),_:2},1024)],8,ne))),128))]),f("div",null,[n(A,{"card-view":"",meta:i.meta,onRefresh:b[3]||(b[3]=s=>d(m).emit("listItems"))},null,8,["meta"])])]),_:1},8,["header","meta"])]),_:1})):(l(),y(t,{key:1,appear:"",visibility:!0},{default:e(()=>[n(E,{header:i.headers,meta:i.meta,module:"resource.diary",onRefresh:b[5]||(b[5]=s=>d(m).emit("listItems"))},{actionButton:e(()=>[d($)("student-diary:create")?(l(),y(H,{key:0,onClick:b[4]||(b[4]=s=>d(v).push({name:"ResourceDiaryCreate"}))},{default:e(()=>[c(a(r.$trans("global.add",{attribute:r.$trans("resource.diary.diary")})),1)]),_:1})):g("",!0)]),default:e(()=>[(l(!0),D(S,null,L(i.data,s=>(l(),y(U,{key:s.uuid},{default:e(()=>[n(k,{name:"date"},{default:e(()=>[c(a(s.date.formatted),1)]),_:2},1024),n(k,{name:"records"},{default:e(()=>[(l(!0),D(S,null,L(s.records,_=>{var j;return l(),D("div",null,[c(a(((j=_.batch.course)==null?void 0:j.name)+" "+_.batch.name)+" ",1),_.subject?(l(),y(T,{key:0},{default:e(()=>[c(a(_.subject.name),1)]),_:2},1024)):g("",!0)])}),256))]),_:2},1024),n(k,{name:"employee"},{default:e(()=>{var _;return[c(a(((_=s.employee)==null?void 0:_.name)||"-")+" ",1),n(T,{block:""},{default:e(()=>{var j;return[c(a((j=s.employee)==null?void 0:j.codeNumber),1)]}),_:2},1024)]}),_:2},1024),n(k,{name:"createdAt"},{default:e(()=>[c(a(s.createdAt.formatted),1)]),_:2},1024),n(k,{name:"action"},{default:e(()=>[n(N,null,{default:e(()=>[n(V,{icon:"fas fa-arrow-circle-right",onClick:_=>d(v).push({name:"ResourceDiaryShow",params:{uuid:s.uuid}})},{default:e(()=>[c(a(r.$trans("general.show")),1)]),_:2},1032,["onClick"]),d($)("student-diary:edit")&&s.isEditable?(l(),y(V,{key:0,icon:"fas fa-edit",onClick:_=>d(v).push({name:"ResourceDiaryEdit",params:{uuid:s.uuid}})},{default:e(()=>[c(a(r.$trans("general.edit")),1)]),_:2},1032,["onClick"])):g("",!0),d($)("student-diary:create")?(l(),y(V,{key:1,icon:"fas fa-copy",onClick:_=>d(v).push({name:"ResourceDiaryDuplicate",params:{uuid:s.uuid}})},{default:e(()=>[c(a(r.$trans("general.duplicate")),1)]),_:2},1032,["onClick"])):g("",!0),d($)("student-diary:delete")&&s.isDeletable?(l(),y(V,{key:2,icon:"fas fa-trash",onClick:_=>d(m).emit("deleteItem",{uuid:s.uuid})},{default:e(()=>[c(a(r.$trans("general.delete")),1)]),_:2},1032,["onClick"])):g("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","meta"])]),_:1}))]),_:1})}}});export{pe as default};
