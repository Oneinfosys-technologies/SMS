import{f as R,m as A,n as q,r as l,o as d,q as u,w as e,d as w,s as r,t as i,b as $,e as s,y as k,l as N,u as n,a as j,v as O,F as U,h as E,j as W}from"./app-DCfJDSeM.js";const z={class:"grid grid-cols-3 gap-6"},G={class:"col-span-3 sm:col-span-1"},J={class:"col-span-3 sm:col-span-1"},K={__name:"Filter",emits:["hide"],setup(B,{emit:h}){const v=R(),C=h,y={batches:[],startDate:"",endDate:""},p=A({...y}),f=A({batches:[],isLoaded:!v.query.batches});return q(async()=>{f.batches=v.query.batches?v.query.batches.split(","):[],f.isLoaded=!0}),(b,m)=>{const T=l("BaseSelectSearch"),a=l("DatePicker"),c=l("FilterForm");return d(),u(c,{"init-form":y,form:p,multiple:["batches"],onHide:m[3]||(m[3]=o=>C("hide"))},{default:e(()=>[w("div",z,[w("div",G,[f.isLoaded?(d(),u(T,{key:0,multiple:"",name:"batches",label:b.$trans("global.select",{attribute:b.$trans("academic.batch.batch")}),modelValue:p.batches,"onUpdate:modelValue":m[0]||(m[0]=o=>p.batches=o),"value-prop":"uuid","init-search":f.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:e(o=>[r(i(o.value.course.name)+" "+i(o.value.name),1)]),listOption:e(o=>[r(i(o.option.course.nameWithTerm)+" "+i(o.option.name),1)]),_:1},8,["label","modelValue","init-search"])):$("",!0)]),w("div",J,[s(a,{start:p.startDate,"onUpdate:start":m[1]||(m[1]=o=>p.startDate=o),end:p.endDate,"onUpdate:end":m[2]||(m[2]=o=>p.endDate=o),name:"dateBetween",as:"range",label:b.$trans("general.date_between")},null,8,["start","end","label"])])])]),_:1},8,["form"])}}},Q={name:"AcademicTimetableList"},Y=Object.assign(Q,{setup(B){const h=E(),v=W("emitter");let C=["filter"];k("timetable:create")&&C.unshift("create");let y=[];k("timetable:export")&&(y=["print","pdf","excel"]);const p="academic/timetable/",f=N(!1),b=A({}),m=a=>{Object.assign(b,a)},T=a=>{window.open(`/app/academic/timetables/${a}/export?action=print`)};return(a,c)=>{const o=l("PageHeaderAction"),I=l("PageHeader"),F=l("ParentTransition"),L=l("TextMuted"),D=l("DataCell"),g=l("FloatingMenuItem"),M=l("FloatingMenu"),S=l("DataRow"),V=l("BaseButton"),H=l("DataTable"),P=l("ListItem");return d(),u(P,{"init-url":p,onSetItems:m},{header:e(()=>[s(I,{title:a.$trans("academic.timetable.timetable"),navs:[{label:a.$trans("academic.academic"),path:"Academic"}]},{default:e(()=>[s(o,{url:"academic/timetables/",name:"AcademicTimetable",title:a.$trans("academic.timetable.timetable"),actions:n(C),"dropdown-actions":n(y),"additional-dropdown-actions-query":{details:!0},onToggleFilter:c[0]||(c[0]=t=>f.value=!f.value)},null,8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"])]),filter:e(()=>[s(F,{appear:"",visibility:f.value},{default:e(()=>[s(K,{onRefresh:c[1]||(c[1]=t=>n(v).emit("listItems")),onHide:c[2]||(c[2]=t=>f.value=!1)})]),_:1},8,["visibility"])]),default:e(()=>[s(F,{appear:"",visibility:!0},{default:e(()=>[s(H,{header:b.headers,meta:b.meta,module:"academic.timetable",onRefresh:c[4]||(c[4]=t=>n(v).emit("listItems"))},{actionButton:e(()=>[n(k)("timetable:create")?(d(),u(V,{key:0,onClick:c[3]||(c[3]=t=>n(h).push({name:"AcademicTimetableCreate"}))},{default:e(()=>[r(i(a.$trans("global.add",{attribute:a.$trans("academic.timetable.timetable")})),1)]),_:1})):$("",!0)]),default:e(()=>[(d(!0),j(U,null,O(b.data,t=>(d(),u(S,{key:t.uuid},{default:e(()=>[s(D,{name:"batch"},{default:e(()=>[r(i(t.batch.course.nameWithTerm+" "+t.batch.name)+" ",1),t.room?(d(),u(L,{key:0,block:""},{default:e(()=>{var _;return[r(i(((_=t.room)==null?void 0:_.fullName)||"-"),1)]}),_:2},1024)):$("",!0)]),_:2},1024),s(D,{name:"effectiveDate"},{default:e(()=>[r(i(t.effectiveDate.formatted),1)]),_:2},1024),s(D,{name:"createdAt"},{default:e(()=>[r(i(t.createdAt.formatted),1)]),_:2},1024),s(D,{name:"action"},{default:e(()=>[s(M,null,{default:e(()=>[s(g,{icon:"fas fa-print",onClick:_=>T(t.uuid)},{default:e(()=>[r(i(a.$trans("general.print")),1)]),_:2},1032,["onClick"]),n(k)("timetable:allocate")?(d(),u(g,{key:0,icon:"fas fa-circle-check",onClick:_=>n(h).push({name:"AcademicTimetableAllocation",params:{uuid:t.uuid}})},{default:e(()=>[r(i(a.$trans("academic.timetable.allocation")),1)]),_:2},1032,["onClick"])):$("",!0),s(g,{icon:"fas fa-arrow-circle-right",onClick:_=>n(h).push({name:"AcademicTimetableShow",params:{uuid:t.uuid}})},{default:e(()=>[r(i(a.$trans("general.show")),1)]),_:2},1032,["onClick"]),n(k)("timetable:edit")?(d(),u(g,{key:1,icon:"fas fa-edit",onClick:_=>n(h).push({name:"AcademicTimetableEdit",params:{uuid:t.uuid}})},{default:e(()=>[r(i(a.$trans("general.edit")),1)]),_:2},1032,["onClick"])):$("",!0),n(k)("timetable:create")?(d(),u(g,{key:2,icon:"fas fa-copy",onClick:_=>n(h).push({name:"AcademicTimetableDuplicate",params:{uuid:t.uuid}})},{default:e(()=>[r(i(a.$trans("general.duplicate")),1)]),_:2},1032,["onClick"])):$("",!0),n(k)("timetable:delete")?(d(),u(g,{key:3,icon:"fas fa-trash",onClick:_=>n(v).emit("deleteItem",{uuid:t.uuid})},{default:e(()=>[r(i(a.$trans("general.delete")),1)]),_:2},1032,["onClick"])):$("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","meta"])]),_:1})]),_:1})}}});export{Y as default};
