import{f as M,h as z,j as P,E as w,G,m as L,n as J,I as A,r as d,o as f,a as h,q as j,w as c,e as s,s as F,t as $,b as R,u as t,d as g,x as K,F as N}from"./app-DCfJDSeM.js";const Q={key:0,class:"grid grid-cols-3 gap-6"},W={class:"col-span-3 sm:col-span-1"},X={key:0,class:"col-span-3 sm:col-span-1"},Y={class:"col-span-3 sm:col-span-1"},Z={class:"col-span-3 sm:col-span-1"},ee={class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-1"},ae={class:"mt-4 grid grid-cols-1"},oe={class:"col"},ne={class:"grid grid-cols-1"},le={class:"col"},se={name:"EmployeeRecordForm"},re=Object.assign(se,{props:{employee:{type:Object,default(){return{}}}},setup(i){const p=M(),S=z(),l=P("$trans"),C=P("emitter"),y=i,H=[{key:"period",label:l("employee.record.props.period"),visibility:!0},{key:"department",label:l("employee.department.department"),visibility:!0},{key:"designation",label:l("employee.designation.designation"),visibility:!0},{key:"employmentStatus",label:l("employee.employment_status.employment_status"),visibility:!0}],U={end:!1,endDate:"",startDate:"",department:"",designation:"",employmentStatus:"",remarks:"",media:[],mediaUpdated:!1,mediaToken:w(),mediaHash:[]},O="employee/record/",r=G(O),o=L({...U}),m=L({department:"",designation:"",employmentStatus:"",isLoaded:!1}),x=()=>{o.mediaToken=w(),o.mediaHash=[]},q=n=>{var e,u,v,_,D,V,k,b;Object.assign(U,{end:!!n.isEnded,startDate:(e=n.startDate)==null?void 0:e.value,endDate:n.isEnded?(u=n.endDate)==null?void 0:u.value:"",department:(v=n.department)==null?void 0:v.uuid,designation:(_=n.designation)==null?void 0:_.uuid,employmentStatus:(D=n.employmentStatus)==null?void 0:D.uuid,remarks:n.remarks,media:n.media,mediaToken:n.mediaToken}),Object.assign(o,A(U)),m.department=(V=n.department)==null?void 0:V.name,m.designation=(k=n.designation)==null?void 0:k.name,m.employmentStatus=(b=n.employmentStatus)==null?void 0:b.name,m.isLoaded=!0},I=()=>{C.emit("employeeUpdated"),S.push({name:"EmployeeRecord",params:{uuid:y.employee.uuid}})};return J(()=>{var n,e,u,v,_,D,V,k,b,E,B,T;p.params.muuid||(Object.assign(U,{department:(e=(n=y.employee.lastRecord)==null?void 0:n.department)==null?void 0:e.uuid,designation:(v=(u=y.employee.lastRecord)==null?void 0:u.designation)==null?void 0:v.uuid,employmentStatus:(D=(_=y.employee.lastRecord)==null?void 0:_.employmentStatus)==null?void 0:D.uuid}),Object.assign(o,A(U)),m.department=(k=(V=y.employee.lastRecord)==null?void 0:V.department)==null?void 0:k.name,m.designation=(E=(b=y.employee.lastRecord)==null?void 0:b.designation)==null?void 0:E.name,m.employmentStatus=(T=(B=y.employee.lastRecord)==null?void 0:B.employmentStatus)==null?void 0:T.name,m.isLoaded=!0)}),(n,e)=>{const u=d("DataCell"),v=d("DataRow"),_=d("SimpleTable"),D=d("BaseCard"),V=d("BaseSwitch"),k=d("DatePicker"),b=d("BaseSelectSearch"),E=d("BaseTextarea"),B=d("MediaUpload"),T=d("FormAction");return f(),h(N,null,[i.employee.lastRecord?(f(),j(D,{key:0,"no-padding":"","no-content-padding":"","bottom-content-padding":"",class:"mb-4"},{default:c(()=>[s(_,{header:H},{default:c(()=>[s(v,null,{default:c(()=>[s(u,{name:"period"},{default:c(()=>[F($(i.employee.lastRecord.period),1)]),_:1}),s(u,{name:"department"},{default:c(()=>[F($(i.employee.lastRecord.department.name),1)]),_:1}),s(u,{name:"designation"},{default:c(()=>[F($(i.employee.lastRecord.designation.name),1)]),_:1}),s(u,{name:"employmentStatus"},{default:c(()=>[F($(i.employee.lastRecord.employmentStatus.name),1)]),_:1})]),_:1})]),_:1})]),_:1})):R("",!0),s(T,{"no-data-fetch":"","init-url":O,uuid:t(p).params.uuid,"module-uuid":t(p).params.muuid,"init-form":U,form:o,"set-form":q,"after-submit":I,redirect:{name:"EmployeeRecord",params:{uuid:t(p).params.uuid}},onResetMediaFiles:x},{default:c(()=>[t(p).params.muuid?(f(),h("div",Q,[g("div",W,[s(V,{modelValue:o.end,"onUpdate:modelValue":e[0]||(e[0]=a=>o.end=a),name:"end",label:t(l)("employee.record.props.end"),error:t(r).end,"onUpdate:error":e[1]||(e[1]=a=>t(r).end=a),vertical:""},null,8,["modelValue","label","error"])]),o.end?(f(),h("div",X,[s(k,{modelValue:o.endDate,"onUpdate:modelValue":e[2]||(e[2]=a=>o.endDate=a),name:"endDate",label:t(l)("employee.record.props.end_date"),error:t(r).endDate,"onUpdate:error":e[3]||(e[3]=a=>t(r).endDate=a)},null,8,["modelValue","label","error"])])):R("",!0)])):R("",!0),!o.end||t(p).params.muuid?(f(),h("div",{key:1,class:K(["grid grid-cols-3 gap-6",{"mt-4":t(p).params.muuid}])},[g("div",Y,[s(k,{modelValue:o.startDate,"onUpdate:modelValue":e[4]||(e[4]=a=>o.startDate=a),name:"startDate",label:t(l)("employee.record.props.start_date"),error:t(r).startDate,"onUpdate:error":e[5]||(e[5]=a=>t(r).startDate=a)},null,8,["modelValue","label","error"])]),g("div",Z,[m.isLoaded?(f(),j(b,{key:0,name:"department",label:t(l)("global.select",{attribute:t(l)("employee.department.department")}),modelValue:o.department,"onUpdate:modelValue":e[6]||(e[6]=a=>o.department=a),error:t(r).department,"onUpdate:error":e[7]||(e[7]=a=>t(r).department=a),"label-prop":"name","value-prop":"uuid","init-search":m.department,"init-search-key":"name","search-action":"employee/department/list"},null,8,["label","modelValue","error","init-search"])):R("",!0)]),g("div",ee,[m.isLoaded?(f(),j(b,{key:0,name:"designation",label:t(l)("global.select",{attribute:t(l)("employee.designation.designation")}),modelValue:o.designation,"onUpdate:modelValue":e[8]||(e[8]=a=>o.designation=a),error:t(r).designation,"onUpdate:error":e[9]||(e[9]=a=>t(r).designation=a),"label-prop":"name","value-prop":"uuid","init-search":m.designation,"init-search-key":"name","search-action":"employee/designation/list"},null,8,["label","modelValue","error","init-search"])):R("",!0)]),g("div",te,[m.isLoaded?(f(),j(b,{key:0,name:"employmentStatus",label:t(l)("global.select",{attribute:t(l)("employee.employment_status.employment_status")}),modelValue:o.employmentStatus,"onUpdate:modelValue":e[10]||(e[10]=a=>o.employmentStatus=a),error:t(r).employmentStatus,"onUpdate:error":e[11]||(e[11]=a=>t(r).employmentStatus=a),"label-prop":"name","value-prop":"uuid","init-search":m.employmentStatus,"init-search-key":"name","search-action":"option/list","additional-search-query":{type:"employment_status"}},null,8,["label","modelValue","error","init-search"])):R("",!0)])],2)):R("",!0),g("div",ae,[g("div",oe,[s(E,{modelValue:o.remarks,"onUpdate:modelValue":e[12]||(e[12]=a=>o.remarks=a),name:"remarks",label:t(l)("employee.record.props.remarks"),error:t(r).remarks,"onUpdate:error":e[13]||(e[13]=a=>t(r).remarks=a)},null,8,["modelValue","label","error"])])]),g("div",ne,[g("div",le,[s(B,{multiple:"",label:t(l)("general.file"),module:"employee_record",media:o.media,"media-token":o.mediaToken,onIsUpdated:e[14]||(e[14]=a=>o.mediaUpdated=!0),onSetHash:e[15]||(e[15]=a=>o.mediaHash.push(a))},null,8,["label","media","media-token"])])])]),_:1},8,["uuid","module-uuid","form","redirect"])],64)}}}),me={name:"EmployeeRecordAction"},ie=Object.assign(me,{props:{employee:{type:Object,default(){return{}}}},setup(i){const p=M();return(S,l)=>{const C=d("PageHeaderAction"),y=d("PageHeader"),H=d("ParentTransition");return f(),h(N,null,[s(y,{title:S.$trans(t(p).meta.trans,{attribute:S.$trans(t(p).meta.label)}),navs:[{label:S.$trans("employee.employee"),path:"EmployeeList"},{label:i.employee.contact.name,path:{name:"EmployeeShow",params:{uuid:i.employee.uuid}}},{label:S.$trans("employee.record.record"),path:{name:"EmployeeRecord",params:{uuid:i.employee.uuid}}}]},{default:c(()=>[s(C,{name:"EmployeeRecord",title:S.$trans("employee.record.record"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),s(H,{appear:"",visibility:!0},{default:c(()=>[s(re,{employee:i.employee},null,8,["employee"])]),_:1})],64)}}});export{ie as default};
