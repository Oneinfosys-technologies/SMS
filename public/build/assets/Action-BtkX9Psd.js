import{j as O,f as B,h as T,i as E,E as $,G as M,l as q,m as _,r as i,o as y,q as D,w as c,d as l,e as r,u as o,s as h,t as U,b as I,I as L,a as N,F as Y}from"./app-DCfJDSeM.js";const C={class:"grid grid-cols-4 gap-6"},w={class:"col-span-4 sm:col-span-3"},G={class:"col-span-4 sm:col-span-1"},W={class:"col-span-4 sm:col-span-1"},z={class:"col-span-4 sm:col-span-1"},J={class:"col-span-4 sm:col-span-1"},K={class:"col-span-4 sm:col-span-1"},Q={class:"col-span-4"},X={class:"mt-4 grid grid-cols-1"},Z={class:"col"},x={name:"ResourceAssignmentForm"},ee=Object.assign(x,{setup(k){const b=O("moment"),d=B();T(),E();const u={title:"",type:"",batches:[],subject:"",date:b().format("YYYY-MM-DD"),dueDate:"",description:"",media:[],mediaUpdated:!1,mediaToken:$(),mediaHash:[]},g="resource/assignment/",n=M(g);q(!1);const m=_({subjects:[],types:[]});_({selectedBatch:null,subjects:[]});const s=_({...u}),f=_({batches:[],subject:"",isLoaded:!d.params.uuid}),R=a=>{Object.assign(m,a)},F=()=>{s.mediaToken=$(),s.mediaHash=[]},A=async a=>{var V,p,v;let t=a.records.map(j=>j.batch.uuid)||[];Object.assign(u,{...a,type:((V=a.type)==null?void 0:V.uuid)||"",date:a.date.value,dueDate:a.dueDate.value,batches:t,subject:((v=(p=a.records[0])==null?void 0:p.subject)==null?void 0:v.uuid)||""}),Object.assign(s,L(u)),f.batches=t,f.isLoaded=!0};return(a,t)=>{const V=i("BaseInput"),p=i("BaseSelect"),v=i("BaseSelectSearch"),j=i("DatePicker"),S=i("BaseEditor"),H=i("MediaUpload"),P=i("FormAction");return y(),D(P,{"pre-requisites":!0,onSetPreRequisites:R,"init-url":g,"init-form":u,form:s,setForm:A,redirect:"ResourceAssignment",onResetMediaFiles:F},{default:c(()=>[l("div",C,[l("div",w,[r(V,{type:"text",modelValue:s.title,"onUpdate:modelValue":t[0]||(t[0]=e=>s.title=e),name:"title",label:a.$trans("resource.assignment.props.title"),error:o(n).title,"onUpdate:error":t[1]||(t[1]=e=>o(n).title=e),autofocus:""},null,8,["modelValue","label","error"])]),l("div",G,[r(p,{modelValue:s.type,"onUpdate:modelValue":t[2]||(t[2]=e=>s.type=e),name:"type",label:a.$trans("resource.assignment.props.type"),options:m.types,"label-prop":"name","value-prop":"uuid",error:o(n).type,"onUpdate:error":t[3]||(t[3]=e=>o(n).type=e)},null,8,["modelValue","label","options","error"])]),l("div",W,[f.isLoaded?(y(),D(v,{key:0,multiple:"",name:"batches",label:a.$trans("academic.batch.batch"),modelValue:s.batches,"onUpdate:modelValue":t[4]||(t[4]=e=>s.batches=e),error:o(n).batches,"onUpdate:error":t[5]||(t[5]=e=>o(n).batches=e),"value-prop":"uuid","init-search":f.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:c(e=>[h(U(e.value.course.name)+" - "+U(e.value.name),1)]),listOption:c(e=>[h(U(e.option.course.nameWithTerm)+" - "+U(e.option.name),1)]),_:1},8,["label","modelValue","error","init-search"])):I("",!0)]),l("div",z,[r(p,{modelValue:s.subject,"onUpdate:modelValue":t[6]||(t[6]=e=>s.subject=e),name:"subject",label:a.$trans("academic.subject.subject"),"label-prop":"name","value-prop":"uuid",options:m.subjects,error:o(n).subject,"onUpdate:error":t[7]||(t[7]=e=>o(n).subject=e)},null,8,["modelValue","label","options","error"])]),l("div",J,[r(j,{modelValue:s.date,"onUpdate:modelValue":t[8]||(t[8]=e=>s.date=e),name:"date",label:a.$trans("resource.assignment.props.date"),"no-clear":"",error:o(n).date,"onUpdate:error":t[9]||(t[9]=e=>o(n).date=e)},null,8,["modelValue","label","error"])]),l("div",K,[r(j,{modelValue:s.dueDate,"onUpdate:modelValue":t[10]||(t[10]=e=>s.dueDate=e),name:"dueDate",label:a.$trans("resource.assignment.props.due_date"),"no-clear":"",error:o(n).dueDate,"onUpdate:error":t[11]||(t[11]=e=>o(n).dueDate=e)},null,8,["modelValue","label","error"])]),l("div",Q,[r(S,{modelValue:s.description,"onUpdate:modelValue":t[12]||(t[12]=e=>s.description=e),name:"description",edit:!!o(d).params.uuid,label:a.$trans("resource.assignment.props.description"),error:o(n).description,"onUpdate:error":t[13]||(t[13]=e=>o(n).description=e)},null,8,["modelValue","edit","label","error"])])]),l("div",X,[l("div",Z,[r(H,{multiple:"",label:a.$trans("general.file"),module:"assignment",media:s.media,"media-token":s.mediaToken,onIsUpdated:t[14]||(t[14]=e=>s.mediaUpdated=!0),onSetHash:t[15]||(t[15]=e=>s.mediaHash.push(e))},null,8,["label","media","media-token"])])])]),_:1},8,["form"])}}}),te={name:"ResourceAssignmentAction"},ae=Object.assign(te,{setup(k){const b=B();return(d,u)=>{const g=i("PageHeaderAction"),n=i("PageHeader"),m=i("ParentTransition");return y(),N(Y,null,[r(n,{title:d.$trans(o(b).meta.trans,{attribute:d.$trans(o(b).meta.label)}),navs:[{label:d.$trans("resource.resource"),path:"Resource"},{label:d.$trans("resource.assignment.assignment"),path:"ResourceAssignmentList"}]},{default:c(()=>[r(g,{name:"ResourceAssignment",title:d.$trans("resource.assignment.assignment"),actions:["list"]},null,8,["title"])]),_:1},8,["title","navs"]),r(m,{appear:"",visibility:!0},{default:c(()=>[r(ee)]),_:1})],64)}}});export{ae as default};
