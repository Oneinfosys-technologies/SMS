import{f as k,j as O,m as h,G as N,n as U,r as l,o as p,q as V,w as o,d as g,e as s,y as E,l as B,a as F,u as R,F as D,v as H,s as $,t as q,h as W,i as G}from"./app-DCfJDSeM.js";const z={class:"grid grid-cols-3 gap-6"},I={class:"col-span-3 sm:col-span-1"},J={class:"col-span-3 sm:col-span-1"},K={class:"col-span-3 sm:col-span-1"},Q={class:"col-span-3 sm:col-span-1"},X={__name:"Filter",props:{initUrl:{type:String,default:""},preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(u,{emit:m}){k(),O("moment");const y=m,b=u,c={startDate:"",endDate:"",period:"",ledgers:[],paymentMethods:[]},t=h({...c});N(b.initUrl);const i=h({isLoaded:!0});return U(async()=>{i.isLoaded=!0}),(n,a)=>{const r=l("DatePicker"),f=l("BaseSelect"),_=l("FilterForm");return p(),V(_,{"init-form":c,multiple:[],form:t,onHide:a[5]||(a[5]=e=>y("hide"))},{default:o(()=>[g("div",z,[g("div",I,[s(r,{start:t.startDate,"onUpdate:start":a[0]||(a[0]=e=>t.startDate=e),end:t.endDate,"onUpdate:end":a[1]||(a[1]=e=>t.endDate=e),name:"dateBetween",as:"range",label:n.$trans("general.date_between")},null,8,["start","end","label"])]),g("div",J,[s(f,{name:"period",label:n.$trans("global.select",{attribute:n.$trans("academic.period.period")}),modelValue:t.period,"onUpdate:modelValue":a[2]||(a[2]=e=>t.period=e),"label-prop":"name","value-prop":"uuid",options:u.preRequisites.periods},null,8,["label","modelValue","options"])]),g("div",K,[s(f,{multiple:"",name:"ledgers",label:n.$trans("global.select",{attribute:n.$trans("finance.ledger.ledger")}),modelValue:t.ledgers,"onUpdate:modelValue":a[3]||(a[3]=e=>t.ledgers=e),"label-prop":"name","value-prop":"uuid",options:u.preRequisites.ledgers},null,8,["label","modelValue","options"])]),g("div",Q,[s(f,{multiple:"",modelValue:t.paymentMethods,"onUpdate:modelValue":a[4]||(a[4]=e=>t.paymentMethods=e),name:"paymentMethods",label:n.$trans("finance.payment_method.payment_method"),"label-prop":"name","value-prop":"uuid",options:u.preRequisites.paymentMethods},null,8,["modelValue","label","options"])])])]),_:1},8,["form"])}}},Y={name:"FinanceReportHeadWiseFeePayment"},x=Object.assign(Y,{setup(u){const m=k();W();const y=G();let b=["filter"],c=[];E("finance:export")&&(c=["print","pdf","excel"]);const t="finance/report/",i=B(!1),n=B(!1),a=h({periods:[],ledgers:[],paymentMethods:[]}),r=h({headers:[],data:[],meta:{total:0}}),f=async()=>{n.value=!0,await y.dispatch(t+"preRequisite",{name:"head-wise-fee-payment",params:m.query}).then(e=>{n.value=!1,Object.assign(a,e)}).catch(e=>{n.value=!1})},_=async()=>{n.value=!0,await y.dispatch(t+"fetchReport",{name:"head-wise-fee-payment",params:m.query}).then(e=>{n.value=!1,Object.assign(r,e)}).catch(e=>{n.value=!1})};return U(async()=>{await f(),await _()}),(e,v)=>{const M=l("PageHeaderAction"),j=l("PageHeader"),P=l("ParentTransition"),w=l("DataCell"),C=l("DataRow"),T=l("DataTable"),A=l("BaseCard");return p(),F(D,null,[s(j,{title:e.$trans(R(m).meta.label),navs:[{label:e.$trans("finance.finance"),path:"Finance"},{label:e.$trans("finance.report.report"),path:"FinanceReport"}]},{default:o(()=>[s(M,{url:"finance/reports/head-wise-fee-payment/",name:"FinanceReportHeadWiseFeePayment",title:e.$trans("finance.report.head_wise_fee_payment.head_wise_fee_payment"),actions:R(b),"dropdown-actions":R(c),headers:r.headers,onToggleFilter:v[0]||(v[0]=d=>i.value=!i.value)},null,8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),s(P,{appear:"",visibility:i.value},{default:o(()=>[s(X,{onAfterFilter:_,"init-url":t,"pre-requisites":a,onHide:v[1]||(v[1]=d=>i.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"]),s(P,{appear:"",visibility:!0},{default:o(()=>[s(A,{"no-padding":"","no-content-padding":"","is-loading":n.value},{default:o(()=>[s(T,{header:r.headers,"sticky-columns":["date"],footer:r.footers,meta:r.meta,module:"finance.report.head_wise_fee_payment",onRefresh:_},{default:o(()=>[(p(!0),F(D,null,H(r.data,d=>(p(),V(C,{key:d.uuid},{default:o(()=>[s(w,{"sticky-column":"",name:"date"},{default:o(()=>[$(q(d.date.formatted),1)]),_:2},1024),(p(!0),F(D,null,H(d.feeHeads,(S,L)=>(p(),V(w,{name:L},{default:o(()=>[$(q(S.formatted),1)]),_:2},1032,["name"]))),256)),s(w,{name:"total"},{default:o(()=>[$(q(d.total.formatted),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{x as default};
