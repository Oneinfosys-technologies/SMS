import{f as R,j as A,m as N,G as L,n as S,r as c,o as h,q as B,w as t,d as p,e,s as m,t as s,b as j,y as O,l as w,a as U,u as $,F as k,v as M,i as E}from"./app-DCfJDSeM.js";const I={class:"grid grid-cols-3 gap-6"},G={class:"col-span-3 sm:col-span-1"},W={class:"col-span-3 sm:col-span-1"},z={class:"col-span-3 sm:col-span-1"},J={class:"col-span-3 sm:col-span-1"},K={class:"col-span-3 sm:col-span-1"},Q={class:"col-span-3 sm:col-span-1"},X={class:"col-span-3 sm:col-span-1"},Y={__name:"Filter",props:{initUrl:{type:String,default:""}},emits:["hide"],setup(T,{emit:v}){const b=R();A("moment");const g=v,y=T,_={codeNumber:"",name:"",batches:[],minTotal:"",minPaid:"",minConcession:"",minBalance:""},n=N({..._});L(y.initUrl);const d=N({isLoaded:!b.query.batches});return S(async()=>{d.batches=b.query.batches?b.query.batches.split(","):[],d.isLoaded=!0}),(o,l)=>{const i=c("BaseInput"),f=c("BaseSelectSearch"),V=c("FilterForm");return h(),B(V,{"init-form":_,multiple:["batches"],form:n,onHide:l[7]||(l[7]=a=>g("hide"))},{default:t(()=>[p("div",I,[p("div",G,[e(i,{type:"text",modelValue:n.codeNumber,"onUpdate:modelValue":l[0]||(l[0]=a=>n.codeNumber=a),name:"codeNumber",label:o.$trans("student.admission.props.code_number")},null,8,["modelValue","label"])]),p("div",W,[e(i,{type:"text",modelValue:n.name,"onUpdate:modelValue":l[1]||(l[1]=a=>n.name=a),name:"name",label:o.$trans("contact.props.name")},null,8,["modelValue","label"])]),p("div",z,[d.isLoaded?(h(),B(f,{key:0,multiple:"",name:"batches",label:o.$trans("global.select",{attribute:o.$trans("academic.batch.batch")}),modelValue:n.batches,"onUpdate:modelValue":l[2]||(l[2]=a=>n.batches=a),"value-prop":"uuid","init-search":d.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:t(a=>[m(s(a.value.course.name)+" "+s(a.value.name),1)]),listOption:t(a=>[m(s(a.option.course.nameWithTerm)+" "+s(a.option.name),1)]),_:1},8,["label","modelValue","init-search"])):j("",!0)]),p("div",J,[e(i,{type:"text",modelValue:n.minTotal,"onUpdate:modelValue":l[3]||(l[3]=a=>n.minTotal=a),name:"minTotal",label:o.$trans("global.min_item",{attribute:o.$trans("finance.fee.total")})},null,8,["modelValue","label"])]),p("div",K,[e(i,{type:"text",modelValue:n.minPaid,"onUpdate:modelValue":l[4]||(l[4]=a=>n.minPaid=a),name:"minPaid",label:o.$trans("global.min_item",{attribute:o.$trans("finance.fee.paid")})},null,8,["modelValue","label"])]),p("div",Q,[e(i,{type:"text",modelValue:n.minConcession,"onUpdate:modelValue":l[5]||(l[5]=a=>n.minConcession=a),name:"minConcession",label:o.$trans("global.min_item",{attribute:o.$trans("finance.fee.concession")})},null,8,["modelValue","label"])]),p("div",X,[e(i,{type:"text",modelValue:n.minBalance,"onUpdate:modelValue":l[6]||(l[6]=a=>n.minBalance=a),name:"minBalance",label:o.$trans("global.min_item",{attribute:o.$trans("finance.fee.balance")})},null,8,["modelValue","label"])])])]),_:1},8,["form"])}}},Z={name:"FinanceReportFeeSummary"},ee=Object.assign(Z,{setup(T){const v=R(),b=E();let g=["filter"],y=[];O("finance:export")&&(y=["print","pdf","excel"]);const _="finance/report/",n=w(!1),d=w(!1),o=N({headers:[],data:[],meta:{total:0}}),l=async()=>{d.value=!0,await b.dispatch(_+"fetchReport",{name:"fee-summary",params:v.query}).then(i=>{d.value=!1,Object.assign(o,i)}).catch(i=>{d.value=!1})};return S(async()=>{await l()}),(i,f)=>{const V=c("PageHeaderAction"),a=c("PageHeader"),C=c("ParentTransition"),u=c("DataCell"),F=c("TextMuted"),D=c("DataRow"),P=c("DataTable"),H=c("BaseCard");return h(),U(k,null,[e(a,{title:i.$trans($(v).meta.label),navs:[{label:i.$trans("finance.finance"),path:"Finance"},{label:i.$trans("finance.report.report"),path:"FinanceReport"}]},{default:t(()=>[e(V,{url:"finance/reports/fee-summary/",name:"FinanceReportFeeSummary",title:i.$trans("finance.report.fee_summary.fee_summary"),actions:$(g),"dropdown-actions":$(y),headers:o.headers,onToggleFilter:f[0]||(f[0]=r=>n.value=!n.value)},null,8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),e(C,{appear:"",visibility:n.value},{default:t(()=>[e(Y,{onAfterFilter:l,"init-url":_,onHide:f[1]||(f[1]=r=>n.value=!1)})]),_:1},8,["visibility"]),e(C,{appear:"",visibility:!0},{default:t(()=>[e(H,{"no-padding":"","no-content-padding":"","is-loading":d.value},{default:t(()=>[e(P,{header:o.headers,footer:o.footers,meta:o.meta,module:"finance.report.fee_summary",onRefresh:l},{default:t(()=>[(h(!0),U(k,null,M(o.data,(r,q)=>(h(),B(D,{key:r.uuid},{default:t(()=>[e(u,{name:"sno"},{default:t(()=>[m(s(o.meta.sno+q),1)]),_:2},1024),e(u,{name:"codeNumber"},{default:t(()=>[m(s(r.codeNumber),1)]),_:2},1024),e(u,{name:"name"},{default:t(()=>[m(s(r.name)+" ",1),e(F,{block:""},{default:t(()=>[m(s(r.rollNumber),1)]),_:2},1024)]),_:2},1024),e(u,{name:"fatherName"},{default:t(()=>[m(s(r.fatherName)+" ",1),e(F,{block:""},{default:t(()=>[m(s(r.contactNumber),1)]),_:2},1024)]),_:2},1024),e(u,{name:"course"},{default:t(()=>[m(s(r.courseName)+" ",1),e(F,{block:""},{default:t(()=>[m(s(r.batchName),1)]),_:2},1024)]),_:2},1024),e(u,{name:"totalFee"},{default:t(()=>[m(s(r.total.formatted),1)]),_:2},1024),e(u,{name:"concessionFee"},{default:t(()=>[m(s(r.concession.formatted),1)]),_:2},1024),e(u,{name:"paidFee"},{default:t(()=>[m(s(r.paid.formatted),1)]),_:2},1024),e(u,{name:"balanceFee"},{default:t(()=>[m(s(r.balance.formatted),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{ee as default};
