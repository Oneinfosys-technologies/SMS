import{l as H,m as k,G as S,n as q,a,e as t,w as c,F as _,I as C,r as i,o as s,d as l,v as V,s as y,t as f,b as E,u as $,f as M,h as L,i as G}from"./app-DCfJDSeM.js";const z={class:"divide-y divide-gray-200 dark:divide-gray-700"},J={class:"grid grid-cols-6 gap-2 px-4 py-2"},K={class:"col-span-6 sm:col-span-1"},Q={class:"col-span-6 sm:col-span-5"},W={class:"flex flex-col sm:flex-row gap-2"},X={class:"w-full"},Y={key:0},Z={class:"col-span-6 sm:col-span-1"},x={class:"col-span-6 sm:col-span-5"},I={key:0,class:"flex flex-col sm:flex-row gap-2"},ee={class:"w-full"},ae={key:0,class:"flex justify-center"},se={key:1},te={class:"flex justify-center"},oe={name:"AcademicTimetableAllocation"},ie=Object.assign(oe,{setup(le){const w=M();L();const A=G(),b={days:[]},h="academic/timetable/",r=H(!1),m=k({sessions:[],subjects:[],rooms:[]}),v=S(h),j=k({...b}),T=k({}),U=async()=>{r.value=!0,await A.dispatch(h+"get",{uuid:w.params.uuid,params:{detail:!0}}).then(e=>{r.value=!1,m.sessions=e.days[0].sessions,Object.assign(T,e),Object.assign(b,e),Object.assign(j,C(b))}).catch(e=>{r.value=!1})},P=async()=>{r.value=!0,await A.dispatch(h+"allocationPreRequisite",{uuid:w.params.uuid}).then(e=>{r.value=!1,Object.assign(m,e)}).catch(e=>{r.value=!1})};return q(async()=>{await U(),await P()}),(e,ne)=>{const F=i("PageHeaderAction"),N=i("PageHeader"),g=i("BaseDataView"),O=i("TextMuted"),B=i("BaseSelect"),R=i("FormAction"),D=i("ParentTransition");return s(),a(_,null,[t(N,{title:e.$trans("academic.timetable.allocation"),navs:[{label:e.$trans("academic.academic"),path:"Academic"},{label:e.$trans("academic.timetable.timetable"),path:"AcademicTimetable"}]},{default:c(()=>[t(F,{name:"AcademicTimetable",title:e.$trans("academic.timetable.timetable"),actions:[]},null,8,["title"])]),_:1},8,["title","navs"]),t(D,{appear:"",visibility:!0},{default:c(()=>[t(R,{"no-data-fetch":!0,"init-url":h,"init-form":b,form:j,action:"allocation","keep-adding":!1,"stay-on":!0},{default:c(()=>[l("div",z,[l("div",J,[l("div",K,[t(g)]),l("div",Q,[l("div",W,[(s(!0),a(_,null,V(m.sessions,o=>(s(),a("div",X,[t(g,null,{default:c(()=>[y(f(o.name)+" ",1),o.isBreak?(s(),a("span",Y,"("+f(e.$trans("academic.class_timing.break"))+")",1)):E("",!0),t(O,{block:""},{default:c(()=>[y(f(o.duration),1)]),_:2},1024)]),_:2},1024)]))),256))])])]),(s(!0),a(_,null,V(j.days,(o,d)=>(s(),a("div",{class:"grid grid-cols-6 gap-2 px-2 py-2",key:o.value},[l("div",Z,[t(g,null,{default:c(()=>[y(f(o.label),1)]),_:2},1024)]),l("div",x,[o.sessions.length>0?(s(),a("div",I,[(s(!0),a(_,null,V(o.sessions,(p,u)=>(s(),a("div",ee,[p.isBreak?(s(),a("div",ae,"-")):(s(),a(_,{key:1},[t(B,{modelValue:p.subject,"onUpdate:modelValue":n=>p.subject=n,name:`days.${d}.sessions.${u}.subject`,placeholder:e.$trans("academic.subject.subject"),"object-prop":!0,"label-prop":"name","value-prop":"uuid",options:m.subjects,error:$(v)[`days.${d}.sessions.${u}.subject`],"onUpdate:error":n=>$(v)[`days.${d}.sessions.${u}.subject`]=n},null,8,["modelValue","onUpdate:modelValue","name","placeholder","options","error","onUpdate:error"]),t(B,{name:`days.${d}.sessions.${u}.room`,placeholder:e.$trans("asset.building.room.room"),modelValue:p.room,"onUpdate:modelValue":n=>p.room=n,error:$(v)[`days.${d}.sessions.${u}.room`],"onUpdate:error":n=>$(v)[`days.${d}.sessions.${u}.room`]=n,"label-prop":"fullName","value-prop":"uuid",options:m.rooms},null,8,["name","placeholder","modelValue","onUpdate:modelValue","error","onUpdate:error","options"])],64))]))),256))])):(s(),a("div",se,[l("div",te,[t(g,null,{default:c(()=>[y(f(e.$trans("academic.timetable.props.holiday")),1)]),_:1})])]))])]))),128))])]),_:1},8,["form"])]),_:1})],64)}}});export{ie as default};
