import{g as B,G as W,c as G,l as H,m as h,n as M,a as P,d as r,u as a,s as b,t as d,e as m,w as u,F as J,r as c,o as p,q as N,b as g,H as K,i as Q,h as X}from"./app-DCfJDSeM.js";const Y={class:"flex justify-end"},Z={class:"flex justify-center"},ee={href:"/",class:"mb-6"},te=["src"],oe={class:"text-primary dark:text-darken-secondary text-center text-xl"},se={class:"text-dark-primary dark:text-darken-secondary text-center"},re={key:0,class:"mt-8 w-full rounded-lg"},ae={class:"grid grid-cols-3 gap-4"},ne={key:0,class:"col-span-3 sm:col-span-1"},ie={class:"col-span-3 sm:col-span-1"},le={class:"col-span-3 sm:col-span-1"},me={class:"col-span-3 sm:col-span-1"},de={class:"col-span-3 sm:col-span-1"},ue={class:"flex"},pe={class:"col-span-3 sm:col-span-1"},ce={class:"col-span-3 sm:col-span-1"},ge={class:"mt-8"},fe={class:"cursor-pointer"},be={class:"mt-4 grid grid-cols-3 gap-4"},Ne={class:"col-span-3 sm:col-span-1"},f="onlineRegistration/",ke={__name:"Index",setup(ye){const y=Q(),V=X(),x={team:"",period:"",program:"",course:"",firstName:"",middleName:"",lastName:"",contactNumber:"",email:""},U={token:"",code:""},w=B("layout.display").value=="dark"?B("assets.iconLight"):B("assets.icon"),n=W(f);G(()=>`${s.firstName} ${s.middleName} ${s.lastName}`.replace(/\s+/g," "));const F=H(null),s=h({...x}),k=h({token:"",code:""}),l=h({status:!1,response:"",selectedPeriod:null,selectedProgram:null,selectedCourse:null,hasVerificationToken:!1,submissionResponse:""}),i=h({genders:[],relations:[],teams:[],periods:[],programs:[],courses:[]}),S=async()=>{await y.dispatch(f+"preRequisite").then(t=>{i.teams=t.teams,i.genders=t.genders,i.relations=t.relations,t.teams.length==1&&(s.team=t.teams[0].uuid,$(s.team))}).catch(t=>{V.push({name:"Dashboard"})})},$=async t=>{if(s.program="",l.selectedProgram=null,i.programs=[],t==null||_.isEmpty(t)){s.team="";return}s.team=t,await y.dispatch(f+"getPrograms",{team:s.team}).then(e=>{i.programs=e.programs}).catch(e=>{})},T=async t=>{if(s.period="",l.selectedPeriod=null,i.periods=[],t==null||_.isEmpty(t)){s.program={};return}s.program=t.uuid,await y.dispatch(f+"getPeriods",{program:l.selectedProgram.uuid}).then(e=>{i.periods=e.periods}).catch(e=>{})},I=async t=>{if(s.course="",l.selectedCourse=null,i.courses=[],t==null||_.isEmpty(t)){s.period="";return}s.period=t.uuid,await y.dispatch(f+"getCourses",{period:s.period}).then(e=>{i.courses=e.courses}).catch(e=>{})},j=async t=>{if(t==null||_.isEmpty(t)){s.course="",l.selectedCourse=null;return}s.course=t.uuid},L=()=>{i.teams.length==1&&(s.team=i.teams[0].uuid,$(s.team))},O=t=>{l.submissionResponse=t.message,U.token=t.token,Object.assign(k,U),l.hasVerificationToken=!0},q=t=>{console.log("hi"),localStorage.setItem("authToken",t.token),V.push({name:"OnlineRegistrationForm",params:{number:t.applicationNumber}})};return M(async()=>{await S()}),(t,e)=>{const v=c("BaseSelect"),A=c("BaseLabel"),D=c("NameInput"),C=c("BaseInput"),R=c("BaseAlert"),E=c("FormAction"),z=c("BaseLoader");return p(),P(J,null,[r("div",Y,[r("span",{class:"text-sm text-gray-500 cursor-pointer",onClick:e[0]||(e[0]=o=>a(V).push({name:"Dashboard"}))},[e[21]||(e[21]=r("i",{class:"fas fa-home mr-1"},null,-1)),b(" "+d(t.$trans("global.go_to",{attribute:t.$trans("dashboard.home")})),1)])]),r("div",Z,[r("a",ee,[r("img",{class:"h-16 w-auto",src:a(w),alt:""},null,8,te)])]),m(z,{"is-loading":F.value},{default:u(()=>[r("div",null,[r("p",oe,d(t.$trans("student.online_registration.title")),1),r("p",se,d(t.$trans("student.online_registration.subtitle")),1)]),i.teams.length>0?(p(),P("div",re,[l.hasVerificationToken?g("",!0):(p(),N(E,{key:0,"init-url":f,"init-form":x,form:s,action:"initiate","keep-adding":!1,"submit-text":t.$trans("general.proceed"),"after-reset":L,"after-submit":O},{default:u(()=>[r("div",ae,[i.teams.length>1||!s.team?(p(),P("div",ne,[m(v,{modelValue:s.team,"onUpdate:modelValue":e[1]||(e[1]=o=>s.team=o),name:"team",label:t.$trans("team.team"),"label-prop":"name","value-prop":"uuid",options:i.teams,error:a(n).team,"onUpdate:error":e[2]||(e[2]=o=>a(n).team=o),onSelected:$},null,8,["modelValue","label","options","error"])])):g("",!0),r("div",ie,[s.team?(p(),N(v,{key:0,modelValue:l.selectedProgram,"onUpdate:modelValue":e[3]||(e[3]=o=>l.selectedProgram=o),name:"program",label:t.$trans("academic.program.program"),"label-prop":"name","value-prop":"uuid",options:i.programs,"object-prop":!0,error:a(n).program,"onUpdate:error":e[4]||(e[4]=o=>a(n).program=o),onSelected:T},null,8,["modelValue","label","options","error"])):g("",!0)]),r("div",le,[s.program?(p(),N(v,{key:0,modelValue:l.selectedPeriod,"onUpdate:modelValue":e[5]||(e[5]=o=>l.selectedPeriod=o),name:"period",label:t.$trans("academic.period.period"),"label-prop":"name","value-prop":"uuid",options:i.periods,"object-prop":!0,error:a(n).period,"onUpdate:error":e[6]||(e[6]=o=>a(n).period=o),onSelected:I},null,8,["modelValue","label","options","error"])):g("",!0)]),r("div",me,[s.period?(p(),N(v,{key:0,modelValue:l.selectedCourse,"onUpdate:modelValue":e[7]||(e[7]=o=>l.selectedCourse=o),name:"course",label:t.$trans("academic.course.course"),"value-prop":"uuid",options:i.courses,"object-prop":!0,error:a(n).course,"onUpdate:error":e[8]||(e[8]=o=>a(n).course=o),onChange:j},{selectedOption:u(o=>[b(d(o.value.nameWithTerm),1)]),listOption:u(o=>[b(d(o.option.nameWithTerm),1)]),_:1},8,["modelValue","label","options","error"])):g("",!0)]),r("div",de,[m(A,null,{default:u(()=>[b(d(t.$trans("student.props.name")),1)]),_:1}),r("div",ue,[m(D,{firstName:s.firstName,"onUpdate:firstName":e[9]||(e[9]=o=>s.firstName=o),middleName:s.middleName,"onUpdate:middleName":e[10]||(e[10]=o=>s.middleName=o),thirdName:s.thirdName,"onUpdate:thirdName":e[11]||(e[11]=o=>s.thirdName=o),lastName:s.lastName,"onUpdate:lastName":e[12]||(e[12]=o=>s.lastName=o),formErrors:a(n),"onUpdate:formErrors":e[13]||(e[13]=o=>K(n)?n.value=o:null)},null,8,["firstName","middleName","thirdName","lastName","formErrors"])])]),r("div",pe,[m(C,{type:"text",modelValue:s.contactNumber,"onUpdate:modelValue":e[14]||(e[14]=o=>s.contactNumber=o),name:"contactNumber",label:t.$trans("contact.props.contact_number"),error:a(n).contactNumber,"onUpdate:error":e[15]||(e[15]=o=>a(n).contactNumber=o)},null,8,["modelValue","label","error"])]),r("div",ce,[m(C,{type:"text",modelValue:s.email,"onUpdate:modelValue":e[16]||(e[16]=o=>s.email=o),name:"email",label:t.$trans("contact.props.email"),error:a(n).email,"onUpdate:error":e[17]||(e[17]=o=>a(n).email=o)},null,8,["modelValue","label","error"])])]),r("div",ge,[m(R,{size:"xs",design:"info",onClick:e[18]||(e[18]=o=>a(V).push({name:"OnlineRegistrationVerify"}))},{default:u(()=>[r("span",fe,d(t.$trans("student.online_registration.already_have_application_number_info")),1)]),_:1})])]),_:1},8,["form","submit-text"])),l.hasVerificationToken?(p(),N(E,{key:1,"init-url":f,"init-form":U,form:k,action:"confirm","keep-adding":!1,"submit-text":t.$trans("student.online_registration.props.confirm"),"after-submit":q},{default:u(()=>[m(R,{size:"xs",design:"info"},{default:u(()=>[b(d(l.submissionResponse),1)]),_:1}),r("div",be,[r("div",Ne,[m(C,{type:"text",modelValue:k.code,"onUpdate:modelValue":e[19]||(e[19]=o=>k.code=o),name:"code",label:t.$trans("student.online_registration.props.code"),error:a(n).code,"onUpdate:error":e[20]||(e[20]=o=>a(n).code=o)},null,8,["modelValue","label","error"])])])]),_:1},8,["form","submit-text"])):g("",!0)])):g("",!0)]),_:1},8,["is-loading"])],64)}}};export{ke as default};
