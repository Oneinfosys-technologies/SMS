import{f as E,m as B,n as O,r as c,o as u,q as y,w as t,d as _,e as s,b,y as q,l as z,u as g,s as i,t as r,a as I,v as G,F as J,h as K,j as Q}from"./app-DCfJDSeM.js";const W={class:"grid grid-cols-3 gap-6"},X={class:"col-span-3 sm:col-span-1"},Y={class:"col-span-3 sm:col-span-1"},Z={class:"col-span-3 sm:col-span-1"},x={class:"col-span-3 sm:col-span-1"},ee={class:"col-span-3 sm:col-span-1"},te={class:"col-span-3 sm:col-span-1"},ae={class:"col-span-3 sm:col-span-1"},ne={class:"col-span-3 sm:col-span-1"},se={class:"col-span-3 sm:col-span-1"},oe={class:"col-span-3 sm:col-span-1"},le={__name:"Filter",props:{preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(L,{emit:V}){const d=E(),C=V,k=L,R={codeNumber:"",types:[],paymentMethods:[],onlinePaymentMethods:[],period:"",ledgers:[],secondaryLedgers:[],startDate:"",endDate:"",status:"",head:""},a=B({...R}),f=B({isLoaded:!(d.query.types||d.query.paymentMethods||d.query.onlinePaymentMethods||d.query.ledgers||d.query.secondaryLedgers)}),$=B({periods:k.preRequisites.periods,types:k.preRequisites.types,heads:k.preRequisites.heads,paymentMethods:k.preRequisites.paymentMethods,onlinePaymentMethods:k.preRequisites.onlinePaymentMethods});return O(async()=>{f.types=d.query.types?d.query.types.split(","):[],f.paymentMethods=d.query.paymentMethods?d.query.paymentMethods.split(","):[],f.onlinePaymentMethods=d.query.onlinePaymentMethods?d.query.onlinePaymentMethods.split(","):[],f.ledgers=d.query.ledgers?d.query.ledgers.split(","):[],f.secondaryLedgers=d.query.secondaryLedgers?d.query.secondaryLedgers.split(","):[],f.isLoaded=!0}),(m,n)=>{const p=c("BaseInput"),l=c("BaseSelect"),F=c("BaseSelectSearch"),T=c("DatePicker"),N=c("FilterForm");return u(),y(N,{"init-form":R,form:a,multiple:["ledgers","types","paymentMethods","onlinePaymentMethods","secondaryLedgers"],onHide:n[11]||(n[11]=o=>C("hide"))},{default:t(()=>[_("div",W,[_("div",X,[s(p,{type:"text",modelValue:a.codeNumber,"onUpdate:modelValue":n[0]||(n[0]=o=>a.codeNumber=o),name:"codeNumber",label:m.$trans("finance.transaction.props.code_number")},null,8,["modelValue","label"])]),_("div",Y,[s(l,{multiple:"",modelValue:a.types,"onUpdate:modelValue":n[1]||(n[1]=o=>a.types=o),name:"types",label:m.$trans("finance.transaction.props.type"),options:$.types},null,8,["modelValue","label","options"])]),_("div",Z,[s(l,{multiple:"",modelValue:a.paymentMethods,"onUpdate:modelValue":n[2]||(n[2]=o=>a.paymentMethods=o),name:"paymentMethods",label:m.$trans("finance.payment_method.payment_method"),"label-prop":"name","value-prop":"uuid",options:$.paymentMethods},null,8,["modelValue","label","options"])]),_("div",x,[s(l,{multiple:"",modelValue:a.onlinePaymentMethods,"onUpdate:modelValue":n[3]||(n[3]=o=>a.onlinePaymentMethods=o),name:"onlinePaymentMethods",label:m.$trans("finance.payment_method.online_payment_method"),"label-prop":"name","value-prop":"uuid",options:$.onlinePaymentMethods},null,8,["modelValue","label","options"])]),_("div",ee,[s(l,{name:"period",label:m.$trans("global.select",{attribute:m.$trans("academic.period.period")}),modelValue:a.period,"onUpdate:modelValue":n[4]||(n[4]=o=>a.period=o),"label-prop":"name","value-prop":"uuid",options:$.periods},null,8,["label","modelValue","options"])]),_("div",te,[f.isLoaded?(u(),y(F,{key:0,multiple:"",name:"ledgers",label:m.$trans("global.select",{attribute:m.$trans("finance.ledger.ledger")}),modelValue:a.ledgers,"onUpdate:modelValue":n[5]||(n[5]=o=>a.ledgers=o),"label-props":"name","value-prop":"uuid","init-search":f.ledgers,"search-action":"finance/ledger/list"},null,8,["label","modelValue","init-search"])):b("",!0)]),_("div",ae,[f.isLoaded?(u(),y(F,{key:0,multiple:"",name:"secondaryLedgers",label:m.$trans("global.select",{attribute:m.$trans("finance.ledger.secondary_ledger")}),modelValue:a.secondaryLedgers,"onUpdate:modelValue":n[6]||(n[6]=o=>a.secondaryLedgers=o),"label-props":"name","value-prop":"uuid","init-search":f.secondaryLedgers,"search-action":"finance/ledger/list"},null,8,["label","modelValue","init-search"])):b("",!0)]),_("div",ne,[s(T,{start:a.startDate,"onUpdate:start":n[7]||(n[7]=o=>a.startDate=o),end:a.endDate,"onUpdate:end":n[8]||(n[8]=o=>a.endDate=o),name:"dateBetween",as:"range",label:m.$trans("general.date_between")},null,8,["start","end","label"])]),_("div",se,[s(l,{name:"status",label:m.$trans("global.select",{attribute:m.$trans("finance.transaction.props.status")}),modelValue:a.status,"onUpdate:modelValue":n[9]||(n[9]=o=>a.status=o),options:L.preRequisites.statuses},null,8,["label","modelValue","options"])]),_("div",oe,[s(l,{name:"head",label:m.$trans("global.select",{attribute:m.$trans("finance.transaction.props.head")}),modelValue:a.head,"onUpdate:modelValue":n[10]||(n[10]=o=>a.head=o),options:L.preRequisites.heads},null,8,["label","modelValue","options"])])])]),_:1},8,["form"])}}},re={key:0},ie={key:1},de={name:"FinanceTransactionList"},pe=Object.assign(de,{setup(L){const V=K(),d=Q("emitter");let C=["filter"];q("transaction:create")&&C.unshift("create");let k=[];q("transaction:export")&&(k=["print","pdf","excel"]);const R="finance/transaction/",a=B({types:[],paymentMethods:[]}),f=z(!1),$=B({}),m=p=>{Object.assign($,p)},n=p=>{Object.assign(a,p)};return(p,l)=>{const F=c("BaseButton"),T=c("PageHeaderAction"),N=c("PageHeader"),o=c("ParentTransition"),D=c("TextMuted"),U=c("BaseBadge"),v=c("DataCell"),w=c("FloatingMenuItem"),S=c("FloatingMenu"),j=c("DataRow"),A=c("DataTable"),H=c("ListItem");return u(),y(H,{"init-url":R,"pre-requisites":!0,onSetPreRequisites:n,onSetItems:m},{header:t(()=>[s(N,{title:p.$trans("finance.transaction.transaction"),navs:[{label:p.$trans("finance.finance"),path:"Finance"}]},{default:t(()=>[s(T,{url:"finance/transactions/",name:"FinanceTransaction",title:p.$trans("finance.transaction.transaction"),actions:g(C),"dropdown-actions":g(k),onToggleFilter:l[1]||(l[1]=e=>f.value=!f.value)},{after:t(()=>[g(q)("finance:config")?(u(),y(F,{key:0,design:"white",onClick:l[0]||(l[0]=e=>g(V).push({name:"FinanceConfig"}))},{default:t(()=>l[6]||(l[6]=[_("i",{class:"fas fa-cog"},null,-1)])),_:1})):b("",!0)]),_:1},8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"])]),filter:t(()=>[s(o,{appear:"",visibility:f.value},{default:t(()=>[s(le,{onRefresh:l[2]||(l[2]=e=>g(d).emit("listItems")),"pre-requisites":a,onHide:l[3]||(l[3]=e=>f.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"])]),default:t(()=>[s(o,{appear:"",visibility:!0},{default:t(()=>[s(A,{header:$.headers,footer:$.footers,meta:$.meta,module:"finance.transaction",onRefresh:l[5]||(l[5]=e=>g(d).emit("listItems"))},{actionButton:t(()=>[g(q)("transaction:create")?(u(),y(F,{key:0,onClick:l[4]||(l[4]=e=>g(V).push({name:"FinanceTransactionCreate"}))},{default:t(()=>[i(r(p.$trans("global.add",{attribute:p.$trans("finance.transaction.transaction")})),1)]),_:1})):b("",!0)]),default:t(()=>[(u(!0),I(J,null,G($.data,e=>(u(),y(j,{key:e.uuid},{default:t(()=>[s(v,{name:"codeNumber"},{default:t(()=>[i(r(e.codeNumber)+" ",1),e.referenceNumber?(u(),y(D,{key:0,block:""},{default:t(()=>[i(r(e.referenceNumber),1)]),_:2},1024)):b("",!0),e.isRejected?(u(),y(U,{key:1,design:"warning",size:"sm"},{default:t(()=>[i(r(p.$trans("general.rejected")),1)]),_:1})):b("",!0),e.isCancelled?(u(),y(U,{key:2,design:"danger",size:"sm"},{default:t(()=>[i(r(p.$trans("general.cancelled")),1)]),_:1})):b("",!0),e.isOnline&&!e.isCompleted?(u(),y(U,{key:3,design:"danger",size:"sm"},{default:t(()=>[i(r(p.$trans("general.failed")),1)]),_:1})):b("",!0)]),_:2},1024),s(v,{name:"primaryLedger"},{default:t(()=>{var h,M;return[i(r(((M=(h=e.payment)==null?void 0:h.ledger)==null?void 0:M.name)||"-")+" ",1),e.payment?(u(),y(D,{key:0,block:""},{default:t(()=>{var P;return[i(r((P=e.payment)==null?void 0:P.methodName),1)]}),_:2},1024)):b("",!0),e.head?(u(),y(D,{key:1,block:""},{default:t(()=>[i(r(e.head),1)]),_:2},1024)):b("",!0)]}),_:2},1024),s(v,{name:"type"},{default:t(()=>[i(r(e.type.label),1)]),_:2},1024),s(v,{name:"date"},{default:t(()=>[i(r(e.date.formatted),1)]),_:2},1024),s(v,{name:"amount"},{default:t(()=>[i(r(e.amount.formatted),1)]),_:2},1024),s(v,{name:"secondaryLedger"},{default:t(()=>{var h,M,P;return[e.record?(u(),I("span",re,r((M=(h=e.record)==null?void 0:h.ledger)==null?void 0:M.name),1)):b("",!0),(P=e.transactionable)!=null&&P.name?(u(),I("span",ie,[i(r(e.transactionable.name)+" ",1),s(D,{block:""},{default:t(()=>[i(r(e.transactionable.contact),1)]),_:2},1024)])):b("",!0)]}),_:2},1024),s(v,{name:"user"},{default:t(()=>{var h,M;return[i(r(((M=(h=e.user)==null?void 0:h.profile)==null?void 0:M.name)||"-"),1)]}),_:2},1024),s(v,{name:"createdAt"},{default:t(()=>[i(r(e.createdAt.formatted),1)]),_:2},1024),s(v,{name:"action"},{default:t(()=>[s(S,null,{default:t(()=>[s(w,{icon:"fas fa-arrow-circle-right",onClick:h=>g(V).push({name:"FinanceTransactionShow",params:{uuid:e.uuid}})},{default:t(()=>[i(r(p.$trans("general.show")),1)]),_:2},1032,["onClick"]),g(q)("transaction:edit")&&e.isEditable?(u(),y(w,{key:0,icon:"fas fa-edit",onClick:h=>g(V).push({name:"FinanceTransactionEdit",params:{uuid:e.uuid}})},{default:t(()=>[i(r(p.$trans("general.edit")),1)]),_:2},1032,["onClick"])):b("",!0),g(q)("transaction:create")&&e.isEditable?(u(),y(w,{key:1,icon:"fas fa-copy",onClick:h=>g(V).push({name:"FinanceTransactionDuplicate",params:{uuid:e.uuid}})},{default:t(()=>[i(r(p.$trans("general.duplicate")),1)]),_:2},1032,["onClick"])):b("",!0),g(q)("transaction:delete")&&e.isEditable?(u(),y(w,{key:2,icon:"fas fa-trash",onClick:h=>g(d).emit("deleteItem",{uuid:e.uuid})},{default:t(()=>[i(r(p.$trans("general.delete")),1)]),_:2},1032,["onClick"])):b("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1})]),_:1})}}});export{pe as default};
