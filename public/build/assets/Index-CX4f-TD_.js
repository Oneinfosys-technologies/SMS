import{f as G,j as A,m as D,G as L,n as S,r as u,o as y,q as w,w as t,d as b,e,s as i,t as l,b as I,y as M,l as k,a as O,u as F,F as U,v as E,h as W,i as z}from"./app-DCfJDSeM.js";const J={class:"grid grid-cols-3 gap-6"},K={class:"col-span-3 sm:col-span-1"},Q={class:"col-span-3 sm:col-span-1"},X={class:"col-span-3 sm:col-span-1"},Y={class:"col-span-3 sm:col-span-1"},Z={class:"col-span-3 sm:col-span-1"},x={class:"col-span-3 sm:col-span-1"},ee={class:"col-span-3 sm:col-span-1"},ae={__name:"Filter",props:{initUrl:{type:String,default:""},preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup($,{emit:_}){const h=G();A("moment");const V=_,B=$,v={installment:"",codeNumber:"",name:"",batches:[],feeGroup:"",dueOn:"",minDue:""},n=D({...v});L(B.initUrl);const c=D({isLoaded:!h.query.batches});return S(async()=>{c.batches=h.query.batches?h.query.batches.split(","):[],c.isLoaded=!0}),(s,o)=>{const m=u("BaseInput"),N=u("BaseSelectSearch"),g=u("BaseSelect"),d=u("DatePicker"),p=u("FilterForm");return y(),w(p,{"init-form":v,multiple:["batches"],form:n,onHide:o[7]||(o[7]=a=>V("hide"))},{default:t(()=>[b("div",J,[b("div",K,[e(m,{type:"text",modelValue:n.installment,"onUpdate:modelValue":o[0]||(o[0]=a=>n.installment=a),name:"installment",label:s.$trans("finance.fee_structure.installment")},null,8,["modelValue","label"])]),b("div",Q,[e(m,{type:"text",modelValue:n.codeNumber,"onUpdate:modelValue":o[1]||(o[1]=a=>n.codeNumber=a),name:"codeNumber",label:s.$trans("student.admission.props.code_number")},null,8,["modelValue","label"])]),b("div",X,[e(m,{type:"text",modelValue:n.name,"onUpdate:modelValue":o[2]||(o[2]=a=>n.name=a),name:"name",label:s.$trans("contact.props.name")},null,8,["modelValue","label"])]),b("div",Y,[c.isLoaded?(y(),w(N,{key:0,multiple:"",name:"batches",label:s.$trans("global.select",{attribute:s.$trans("academic.batch.batch")}),modelValue:n.batches,"onUpdate:modelValue":o[3]||(o[3]=a=>n.batches=a),"value-prop":"uuid","init-search":c.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:t(a=>[i(l(a.value.course.name)+" "+l(a.value.name),1)]),listOption:t(a=>[i(l(a.option.course.nameWithTerm)+" "+l(a.option.name),1)]),_:1},8,["label","modelValue","init-search"])):I("",!0)]),b("div",Z,[e(g,{name:"feeGroup",label:s.$trans("global.select",{attribute:s.$trans("finance.fee_group.fee_group")}),modelValue:n.feeGroup,"onUpdate:modelValue":o[4]||(o[4]=a=>n.feeGroup=a),options:$.preRequisites.feeGroups,"value-prop":"uuid","label-prop":"name"},null,8,["label","modelValue","options"])]),b("div",x,[e(d,{modelValue:n.dueOn,"onUpdate:modelValue":o[5]||(o[5]=a=>n.dueOn=a),name:"dueOn",as:"date",label:s.$trans("finance.report.fee_due.props.due_on")},null,8,["modelValue","label"])]),b("div",ee,[e(m,{type:"text",modelValue:n.minDue,"onUpdate:modelValue":o[6]||(o[6]=a=>n.minDue=a),name:"minDue",label:s.$trans("global.min_item",{attribute:s.$trans("finance.fee.due")})},null,8,["modelValue","label"])])])]),_:1},8,["form"])}}},te={name:"FinanceReportFeeDue"},oe=Object.assign(te,{setup($){const _=G(),h=W(),V=z();let B=["filter"],v=[];M("finance:export")&&(v=["print","pdf","excel"]);const n="finance/report/",c=k(!1),s=k(!1),o=D({feeGroups:[]}),m=D({headers:[],data:[],meta:{total:0}}),N=async()=>{s.value=!0,await V.dispatch(n+"preRequisite",{name:"fee-due",params:_.query}).then(d=>{s.value=!1,Object.assign(o,d)}).catch(d=>{s.value=!1})},g=async()=>{s.value=!0,await V.dispatch(n+"fetchReport",{name:"fee-due",params:_.query}).then(d=>{s.value=!1,Object.assign(m,d)}).catch(d=>{s.value=!1})};return S(async()=>{await N(),await g()}),(d,p)=>{const a=u("BaseButton"),T=u("PageHeaderAction"),C=u("PageHeader"),q=u("ParentTransition"),f=u("DataCell"),R=u("TextMuted"),j=u("DataRow"),H=u("DataTable"),P=u("BaseCard");return y(),O(U,null,[e(C,{title:d.$trans(F(_).meta.label),navs:[{label:d.$trans("finance.finance"),path:"Finance"},{label:d.$trans("finance.report.report"),path:"FinanceReport"}]},{default:t(()=>[e(T,{url:"finance/reports/fee-due/",name:"FinanceReportFeeDue",title:d.$trans("finance.report.fee_due.fee_due"),actions:F(B),"dropdown-actions":F(v),headers:m.headers,onToggleFilter:p[1]||(p[1]=r=>c.value=!c.value)},{default:t(()=>[e(a,{design:"white",onClick:p[0]||(p[0]=r=>F(h).push({name:"FinanceReportInstallmentWiseFeeDue"}))},{default:t(()=>[i(l(d.$trans("finance.report.installment_wise_fee_due.installment_wise_fee_due")),1)]),_:1})]),_:1},8,["title","actions","dropdown-actions","headers"])]),_:1},8,["title","navs"]),e(q,{appear:"",visibility:c.value},{default:t(()=>[e(ae,{onAfterFilter:g,"init-url":n,"pre-requisites":o,onHide:p[2]||(p[2]=r=>c.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"]),e(q,{appear:"",visibility:!0},{default:t(()=>[e(P,{"no-padding":"","no-content-padding":"","is-loading":s.value},{default:t(()=>[e(H,{header:m.headers,footer:m.footers,meta:m.meta,module:"finance.report.fee_due",onRefresh:g},{default:t(()=>[(y(!0),O(U,null,E(m.data,r=>(y(),w(j,{key:r.uuid},{default:t(()=>[e(f,{name:"codeNumber"},{default:t(()=>[i(l(r.codeNumber),1)]),_:2},1024),e(f,{name:"name"},{default:t(()=>[i(l(r.name)+" ",1),e(R,{block:""},{default:t(()=>[i(l(r.rollNumber),1)]),_:2},1024)]),_:2},1024),e(f,{name:"fatherName"},{default:t(()=>[i(l(r.fatherName)+" ",1),e(R,{block:""},{default:t(()=>[i(l(r.contactNumber),1)]),_:2},1024)]),_:2},1024),e(f,{name:"course"},{default:t(()=>[i(l(r.courseName)+" ",1),e(R,{block:""},{default:t(()=>[i(l(r.batchName),1)]),_:2},1024)]),_:2},1024),e(f,{name:"feeGroup"},{default:t(()=>[i(l(r.feeGroupName),1)]),_:2},1024),e(f,{name:"dueFee"},{default:t(()=>[i(l(r.dueFee.formatted),1)]),_:2},1024),e(f,{name:"finalDueDate"},{default:t(()=>[i(l(r.finalDueDate.formatted),1)]),_:2},1024),e(f,{name:"overdueBy"},{default:t(()=>[i(l(r.overdueBy),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","footer","meta"])]),_:1},8,["is-loading"])]),_:1})],64)}}});export{oe as default};
