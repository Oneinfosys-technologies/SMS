import{f as E,m as q,n as P,r as i,o as p,q as _,w as e,d as D,s as o,t as s,b as g,e as n,y as v,l as W,u as m,a as V,v as T,F as O,h as z,j as G}from"./app-DCfJDSeM.js";const J={class:"grid grid-cols-3 gap-6"},K={class:"col-span-3 sm:col-span-1"},Q={class:"col-span-3 sm:col-span-1"},X={class:"col-span-3 sm:col-span-1"},Y={class:"col-span-3 sm:col-span-1"},Z={__name:"Filter",props:{preRequisites:{type:Object,default(){return{}}}},emits:["hide"],setup(S,{emit:$}){const c=E(),k=$,R=S,C={employees:[],batches:[],subjects:[],startDate:"",endDate:""},l=q({...C}),B=q({subjects:R.preRequisites.subjects}),d=q({employees:[],batches:[],subjects:[],isLoaded:!(c.query.employees||c.query.batches||c.query.subjects)});return P(async()=>{d.employees=c.query.employees?c.query.employees.split(","):[],d.batches=c.query.batches?c.query.batches.split(","):[],d.subjects=c.query.subjects?c.query.subjects.split(","):[],d.isLoaded=!0}),(y,u)=>{const r=i("BaseSelectSearch"),b=i("BaseSelect"),L=i("DatePicker"),w=i("FilterForm");return p(),_(w,{"init-form":C,form:l,multiple:["employees","types","batches","subjects"],onHide:u[5]||(u[5]=t=>k("hide"))},{default:e(()=>[D("div",J,[D("div",K,[d.isLoaded?(p(),_(r,{key:0,multiple:"",name:"employees",label:y.$trans("global.select",{attribute:y.$trans("employee.employee")}),modelValue:l.employees,"onUpdate:modelValue":u[0]||(u[0]=t=>l.employees=t),"value-prop":"uuid","init-search":d.employees,"search-key":"name","search-action":"employee/list"},{selectedOption:e(t=>[o(s(t.value.name)+" ("+s(t.value.codeNumber)+") ",1)]),listOption:e(t=>[o(s(t.option.name)+" ("+s(t.option.codeNumber)+") ",1)]),_:1},8,["label","modelValue","init-search"])):g("",!0)]),D("div",Q,[d.isLoaded?(p(),_(r,{key:0,multiple:"",name:"batches",label:y.$trans("global.select",{attribute:y.$trans("academic.batch.batch")}),modelValue:l.batches,"onUpdate:modelValue":u[1]||(u[1]=t=>l.batches=t),"value-prop":"uuid","init-search":d.batches,"search-key":"course_batch","search-action":"academic/batch/list"},{selectedOption:e(t=>[o(s(t.value.course.name)+" "+s(t.value.name),1)]),listOption:e(t=>[o(s(t.option.course.nameWithTerm)+" "+s(t.option.name),1)]),_:1},8,["label","modelValue","init-search"])):g("",!0)]),D("div",X,[n(b,{multiple:"",modelValue:l.subjects,"onUpdate:modelValue":u[2]||(u[2]=t=>l.subjects=t),name:"subjects",label:y.$trans("academic.subject.subject"),"label-prop":"name","value-prop":"uuid",options:B.subjects},null,8,["modelValue","label","options"])]),D("div",Y,[n(L,{start:l.startDate,"onUpdate:start":u[3]||(u[3]=t=>l.startDate=t),end:l.endDate,"onUpdate:end":u[4]||(u[4]=t=>l.endDate=t),name:"startDateBetween",as:"range",label:y.$trans("general.date_between")},null,8,["start","end","label"])])])]),_:1},8,["form"])}}},x={name:"ResourceLessonPlanList"},te=Object.assign(x,{setup(S){const $=z(),c=G("emitter");let k=["filter"];v("resource:config")&&k.push("config"),v("lesson-plan:create")&&k.unshift("create");let R=[];v("lesson-plan:export")&&(R=["print","pdf","excel"]);const C="resource/lessonPlan/",l=W(!1),B=q({subjects:[]}),d=q({}),y=r=>{Object.assign(B,r)},u=r=>{Object.assign(d,r)};return(r,b)=>{const L=i("PageHeaderAction"),w=i("PageHeader"),t=i("ParentTransition"),h=i("DataCell"),I=i("TextMuted"),F=i("FloatingMenuItem"),M=i("FloatingMenu"),N=i("DataRow"),A=i("BaseButton"),H=i("DataTable"),U=i("ListItem");return p(),_(U,{"init-url":C,"pre-requisites":!0,onSetPreRequisites:y,"additional-query":{},onSetItems:u},{header:e(()=>[n(w,{title:r.$trans("resource.lesson_plan.lesson_plan"),navs:[{label:r.$trans("resource.resource"),path:"Resource"}]},{default:e(()=>[n(L,{url:"resource/lesson-plans/",name:"ResourceLessonPlan",title:r.$trans("resource.lesson_plan.lesson_plan"),actions:m(k),"dropdown-actions":m(R),"config-path":"ResourceConfig",onToggleFilter:b[0]||(b[0]=a=>l.value=!l.value)},null,8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"])]),filter:e(()=>[n(t,{appear:"",visibility:l.value},{default:e(()=>[n(Z,{onRefresh:b[1]||(b[1]=a=>m(c).emit("listItems")),"pre-requisites":B,onHide:b[2]||(b[2]=a=>l.value=!1)},null,8,["pre-requisites"])]),_:1},8,["visibility"])]),default:e(()=>[n(t,{appear:"",visibility:!0},{default:e(()=>[n(H,{header:d.headers,meta:d.meta,module:"resource.lesson_plan",onRefresh:b[4]||(b[4]=a=>m(c).emit("listItems"))},{actionButton:e(()=>[m(v)("lesson-plan:create")?(p(),_(A,{key:0,onClick:b[3]||(b[3]=a=>m($).push({name:"ResourceLessonPlanCreate"}))},{default:e(()=>[o(s(r.$trans("global.add",{attribute:r.$trans("resource.lesson_plan.lesson_plan")})),1)]),_:1})):g("",!0)]),default:e(()=>[(p(!0),V(O,null,T(d.data,a=>(p(),_(N,{key:a.uuid},{default:e(()=>[n(h,{name:"topic"},{default:e(()=>[o(s(a.topicExcerpt),1)]),_:2},1024),n(h,{name:"records"},{default:e(()=>[(p(!0),V(O,null,T(a.records,f=>{var j;return p(),V("div",null,[o(s(((j=f.batch.course)==null?void 0:j.name)+" "+f.batch.name)+" ",1),f.subject?(p(),_(I,{key:0},{default:e(()=>[o(s(f.subject.name),1)]),_:2},1024)):g("",!0)])}),256))]),_:2},1024),n(h,{name:"employee"},{default:e(()=>{var f;return[o(s(((f=a.employee)==null?void 0:f.name)||"-")+" ",1),n(I,{block:""},{default:e(()=>{var j;return[o(s((j=a.employee)==null?void 0:j.codeNumber),1)]}),_:2},1024)]}),_:2},1024),n(h,{name:"startDate"},{default:e(()=>[o(s(a.startDate.formatted),1)]),_:2},1024),n(h,{name:"endDate"},{default:e(()=>[o(s(a.endDate.formatted),1)]),_:2},1024),n(h,{name:"createdAt"},{default:e(()=>[o(s(a.createdAt.formatted),1)]),_:2},1024),n(h,{name:"action"},{default:e(()=>[n(M,null,{default:e(()=>[n(F,{icon:"fas fa-arrow-circle-right",onClick:f=>m($).push({name:"ResourceLessonPlanShow",params:{uuid:a.uuid}})},{default:e(()=>[o(s(r.$trans("general.show")),1)]),_:2},1032,["onClick"]),m(v)("lesson-plan:edit")&&a.isEditable?(p(),_(F,{key:0,icon:"fas fa-edit",onClick:f=>m($).push({name:"ResourceLessonPlanEdit",params:{uuid:a.uuid}})},{default:e(()=>[o(s(r.$trans("general.edit")),1)]),_:2},1032,["onClick"])):g("",!0),m(v)("lesson-plan:create")?(p(),_(F,{key:1,icon:"fas fa-copy",onClick:f=>m($).push({name:"ResourceLessonPlanDuplicate",params:{uuid:a.uuid}})},{default:e(()=>[o(s(r.$trans("general.duplicate")),1)]),_:2},1032,["onClick"])):g("",!0),m(v)("lesson-plan:delete")&&a.isDeletable?(p(),_(F,{key:2,icon:"fas fa-trash",onClick:f=>m(c).emit("deleteItem",{uuid:a.uuid})},{default:e(()=>[o(s(r.$trans("general.delete")),1)]),_:2},1032,["onClick"])):g("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","meta"])]),_:1})]),_:1})}}});export{te as default};
